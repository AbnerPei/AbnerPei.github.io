[{"content":"å¯å‘ åŸæœ¬åœ¨çœ‹ Codable ç›¸å…³çš„ Swiftï¼šJSONè§£æï¼ˆä¸Šï¼‰ ï¼Œçœ‹è¯¥æ–‡ç« å³è¾¹æœ‰ä¸ªç›¸å…³æ¨è Swiftï¼šé€šè¿‡Protocolå°è£…ç»Ÿå’Œå…¥å‚ ï¼Œä¸€å£æ°”æŠŠå®ƒç»™çœ‹å®Œäº†ï¼Œæˆ‘æ—¥å¸¸å¼€å‘çš„ç¼–ç æ€è·¯è·Ÿä½œè€…çš„å¦‚å‡ºä¸€è¾™ï¼Œä½†æœ‰ä¸€ç‚¹å„¿æˆ‘ä¹Ÿæ˜¯ä¸´æ—¶è§‰å¾—æœ‰äº›ä¸å¦¥ï¼šå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒtoString æ¯ä¸ªæšä¸¾é‡Œé¢éƒ½è¦å†™ï¼Œå…¶å®å®Œå…¨æ²¡å¿…è¦ï¼Œé€šè¿‡åè®®æ‰©å±•å¯ä»¥è½»æ¾è§£å†³ï¼ æ”¹è¿› ToStringProtocol çš„æ‰©å±•ï¼Œå¦‚ä¸‹ï¼š\n1 2 3 extension ToStringProtocol where Self: RawRepresentable, Self.RawValue == String { var toString: String { rawValue } } è€Œ ClickEvent ä¸­çš„æšä¸¾ï¼Œæ— è®ºæ˜¯ AControllerã€BControllerï¼Œè¿˜æ˜¯åç»­æ–°å¢çš„ï¼Œéƒ½åªéœ€è¦éµå¾ª ToStringProtocol å³å¯æ‹¥æœ‰ toString å±æ€§ï¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 //protocol ToStringProtocol { // var toString: String { get } //} enum ClickEvent { /// è®©AControlleréµå®ˆToStringProtocol enum AController: String, ToStringProtocol { case oneButtonClick case twoButtonClick } /// è®©BControlleréµå®ˆToStringProtocol enum BController: String, ToStringProtocol { case oneButtonClick case twoButtonClick } } é¡¹ç›®å®æˆ˜ï¼ˆä¼˜åŒ–ï¼‰ æœªä¼˜åŒ–æ—¶ LAccountSettings å’Œ LAccountSettingsAction ä¸­å­˜åœ¨å…±åŒï¼ˆå¯æŠ½ç¦»ï¼‰çš„ä»£ç ï¼š 1 2 3 func language() -\u0026gt; String { rawValue.language() } language() çš„å®ç°ç«Ÿç„¶æ˜¯ String çš„ extensionï¼š 1 2 3 4 5 extension String { func language(table: String? = nil) -\u0026gt; String { Bundle.main.localizedString(forKey: self, value: nil, table: table) } } è¿™æ ·çš„åå¤„å¾ˆæ˜¾ç„¶ï¼šæ‰€æœ‰ String ç±»å‹éƒ½å¯ä»¥è°ƒç”¨ language æ–¹æ³•ï¼\ncase åå­—å¤ªé•¿ã€€ä¼˜åŒ– å…ˆç®€å•ä»‹ç»ä¸‹é¡¹ç›®ä¸­çš„ .strings : Localizable.strings : ç³»ç»Ÿé»˜è®¤ï¼› InfoPlist.strings : ç³»ç»Ÿæƒé™é…ç½®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯»å–ï¼› Onboarding.strings : è‡ªå®šä¹‰ï¼ŒOnboarding ä¸šåŠ¡å¤šè¯­è¨€ï¼› Tool.strings : è‡ªå®šä¹‰ï¼ŒTool ï¼ˆå·¥å…·ï¼‰ä¸šåŠ¡å¤šè¯­è¨€ éœ€è¦ç”¨åˆ°çš„ API ï¼šlocalizedString(forKey:value:table:) 1 2 /* Methods for retrieving localized strings. */ open func localizedString(forKey key: String, value: String?, table tableName: String?) -\u0026gt; String key: è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²é”®ã€‚ value: å¦‚æœåœ¨æŒ‡å®šçš„ Localizable.strings æ–‡ä»¶ä¸­æœªæ‰¾åˆ° keyï¼Œå°†è¿”å›æ­¤å€¼ã€‚å¦‚æœä¸º nilï¼Œåˆ™è¿”å› key æœ¬èº«ã€‚ tableName: Localizable.strings æ–‡ä»¶çš„åç§°ã€‚å¦‚æœä¸º nilï¼Œé»˜è®¤ä½¿ç”¨ Localizable.stringsã€‚ NOTEï¼šå½“å‰å¼€å‘ä¸­ï¼Œåªéœ€è¦ key å’Œ tableNameï¼\nè®¾è®¡æšä¸¾ Table ï¼Œç®¡ç† .strings InfoPlist.strings æ˜¯ç³»ç»Ÿè¯»å–ï¼Œæ‰€ä»¥å·¥ç¨‹è¦é…ç½®ï¼Œä½†æ˜¯å¼€å‘ä¸ç”¨ç®¡ï¼\n1 2 3 4 5 6 7 8 9 enum Table: String { case `default` = \u0026#34;Localizable\u0026#34; case Onboarding case Tool func language(forKey key: String) -\u0026gt; String { Bundle.main.localizedString(forKey: key, value: nil, table: rawValue) } } NOTEï¼šä¸€ä¸ªå®—æ—¨ï¼šé¡¹ç›®ä¸­å¤šè¯­è¨€å­—ç¬¦ä¸²ï¼Œå…¨éƒ¨æ˜ å°„ä¸ºç›¸åº”çš„æšä¸¾ï¼Œé˜²æ­¢å› å­—ç¬¦ä¸²å‡ºé”™ï¼ˆå¦‚å°‘ä¸€ä¸ªå­—æ¯ã€å¤šä¸€ä¸ªå­—æ¯ç­‰ï¼‰è€Œä¸æ˜“æ’æŸ¥é—®é¢˜ï¼\né‡‡ç”¨ Table æšä¸¾çš„å¥½å¤„ï¼š\nä¾¿äºç®¡ç†æ‰€æœ‰ table ï¼Œé˜²æ­¢å› å­—ç¬¦ä¸²å‡ºé”™è€Œä¸æ˜“æ’æŸ¥ï¼› å¯¹ localizedString(forKey:value:table:) çš„å°è£…ï¼Œä¾¿äºå†…å¤–éƒ¨è°ƒç”¨ ï¼ˆå¤–éƒ¨è°ƒç”¨ï¼Œå°±ç®—ä¸éµå¾ª MultiLanguage ä¹Ÿå¯ä»¥ä¾¿æ·è°ƒç”¨ï¼‰ è®¾è®¡ MultiLanguage åè®®ï¼Œæ‰©å±• MultiLanguage åè®® 1 2 3 4 5 6 7 8 9 10 11 12 13 protocol MultiLanguage { var specialKey: String { get } var table: Table { get } var language: String { get } } extension MultiLanguage where Self: RawRepresentable, Self.RawValue == String { var specialKey: String { rawValue } var table: Table { .default } var language: String { return table.language(forKey: specialKey) } } MultiLanguage æ‰©å±•é‡‡ç”¨ where Self: RawRepresentable, Self.RawValue == Stringï¼Œæ¥é™åˆ¶éµå¾ª MultiLanguage åè®®çš„å¯¹è±¡ä¸ºåŸå§‹å€¼ç±»å‹ä¸º String çš„æšä¸¾ï¼ MultiLanguage æ‰©å±•æä¾›äº†é»˜è®¤å®ç° specialKey Qï¼šä¸ºä»€ä¹ˆ MultiLanguage åè®®è¦è®¾è®¡ä¸€ä¸ª specialKey å±æ€§ï¼Ÿæ˜æ˜ä¸Šé¢æåˆ° localizedString(forKey:value:table:) åªéœ€è¦ key å’Œ tableName å°±å¯ä»¥ã€‚\nAï¼šåœ¨ XX.strings æ–‡ä»¶ä¸­ï¼Œå¤šè¯­è¨€çš„ key æˆ‘ä¸ªäººæ›´å€¾å‘ç»‘å®šä¸Šä¸šåŠ¡ï¼Œå¦‚ account_settings_Emailã€account_settings_Nameï¼Œaccount_settings_action_logoutã€account_settings_action_delete_account ï¼ˆè¯¦è§ä¸Š .strings å¤„çš„æˆªå›¾ï¼‰ï¼Œè€Œä¸æ˜¯å•ä¸€çš„ Emailã€Nameã€logoutã€delete_accountã€‚\nå°è±¡æœ€æ·±çš„ä¸€ä¸ªç¿»è¯‘ï¼šNext ï¼Œé¡¹ç›®ä¸­æœ‰ä¸‹ä¸€æ¬¡ï¼Œä¹Ÿæœ‰ä¸‹ä¸€æ­¥ï¼Œæ‰€ä»¥ä¸èƒ½å•ä¸€çš„ Next ï¼ˆè¿™ä¸ªçœŸå®é¡¹ç›®å†™ä¸€å†™ï¼Œå°±èƒ½ä½“ä¼šå…¶ä¸­æ»‹å‘³ï¼‰ã€‚ æ–°å¢ç»§æ‰¿åè®®ï¼Œå¤„ç†è‡ªå®šä¹‰çš„ .strings 1 2 3 4 5 6 7 8 9 protocol ToolMultiLanguage: MultiLanguage { } extension ToolMultiLanguage { var table: Table { .Tool } } protocol OnboardingMultiLanguage: MultiLanguage { } extension OnboardingMultiLanguage { var table: Table { .Onboarding } } å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œå¯¹äº Tool å’Œ Onboardingï¼Œåªéœ€è¦æ–°å»ºç»§æ‰¿è‡ª MultiLanguage çš„åè®®ï¼Œå¹¶é‡å†™ table å³å¯ï¼ ç¤ºä¾‹ 1ã€æ–°å»ºç©ºçš„æšä¸¾ LTxt 1 2 /// æ–‡å­— enum LTxt {} 2ã€åœ¨ LTxt çš„ extension ä¸­æ–°å¢å„ç§ enumï¼Œå¹¶ä½¿å…¶éµå¾ª MultiLanguage ç­‰åè®® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 //!!!: Profile - Account Settings extension LTxt { enum AccountSettings: String, MultiLanguage { case Email case Name case Gender case Age case Height var specialKey: String { \u0026#34;account_settings_\u0026#34; + rawValue } enum Action: String, MultiLanguage { case logout case delete_account var specialKey: String { \u0026#34;account_settings_action_\u0026#34; + rawValue } } } } è°ƒç”¨ï¼š\n1 make.setTitle(LTxt.AccountSettings.Action.logout.language, for: .normal) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 //!!!: é¥±è…¹æ„Ÿ extension LTxt { enum FeelingFullNess: String, CaseIterable, ToolMultiLanguage { case Starving case Hungry case Neutral case Satisfied case Full var specialKey: String { \u0026#34;feeling_fullness_\u0026#34; + rawValue } static var all: [String] { Self.allCases.map({ $0.language })} } } è°ƒç”¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 func getBtLb(at idx: Int, title: LTxt.FeelingFullNess) -\u0026gt; (idxBt: UIButton, idxLb: UILabel) { let bt = UIButton(type: .custom).then { make in bgView.addSubview(make) } let lb = UILabel(font: .quicksandMedium(12~), textColor: .C_151515_70).then({ make in bgView.addSubview(make) make.text = title.language }) return (bt, lb) } æ€»ç»“ï¼ˆæ„Ÿæ…¨ï¼‰ Swift çš„åè®®ï¼ŒçœŸçš„æ˜¯ä¸ªå¥½ä¸œä¸œï¼Œå†æ¬¡æ„Ÿå—åˆ°ç¼–ç çš„æ„‰æ‚¦ï¼Œä¸Šä¸€æ¬¡çš„æ„‰æ‚¦æ¥è‡ª å…³äºSocketæ¨é€å¤„ç†çš„æ”¹è¿›ã€‚ é™„å½•ï¼šç»Ÿå’Œå…¥å‚ æ¥è‡ª ChatGPT ã€‚\nç»Ÿå’Œå…¥å‚ è¿™ä¸ªè¯æ±‡é€šå¸¸å‡ºç°åœ¨è½¯ä»¶å¼€å‘ã€ç³»ç»Ÿè®¾è®¡æˆ–è€…ä¸šåŠ¡æµç¨‹çš„åœºæ™¯ä¸­ï¼ŒæŒ‡çš„æ˜¯åœ¨è¿›è¡Œç³»ç»Ÿè®¾è®¡æˆ–å¼€å‘æ—¶ï¼Œå°†å¤šä¸ªä¸åŒæ¥æºæˆ–ç±»å‹çš„è¾“å…¥å‚æ•°è¿›è¡Œç»Ÿä¸€å’Œæ•´åˆçš„è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹çš„ç›®æ ‡æ˜¯ç®€åŒ–æ¥å£è®¾è®¡ã€å‡å°‘å¤æ‚æ€§ï¼Œä»¥åŠæé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œçµæ´»æ€§ã€‚ èƒŒæ™¯ åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œå¾€å¾€ä¼šæœ‰å¤šä¸ªæ¥å£ã€æœåŠ¡æˆ–è€…æ¨¡å—ä¹‹é—´éœ€è¦è¿›è¡Œæ•°æ®ä¼ é€’ã€‚ä¸åŒçš„æ¨¡å—å¯èƒ½éœ€è¦ä¸åŒç±»å‹çš„è¾“å…¥å‚æ•°ï¼Œè€Œè¿™äº›å‚æ•°å¯èƒ½æ¥æºäºä¸åŒçš„ç³»ç»Ÿæˆ–ç”¨æˆ·è¾“å…¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ¯ä¸ªæ¨¡å—éƒ½è®¾è®¡è‡ªå·±çš„ç‹¬ç«‹å‚æ•°ç»“æ„ï¼Œç³»ç»Ÿå°±ä¼šå˜å¾—å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚ã€€æ„ä¹‰ ç»Ÿå’Œå…¥å‚ çš„ä½œç”¨å°±æ˜¯åœ¨è¿™æ ·çš„åœºæ™¯ä¸‹ï¼Œå°†è¿™äº›ä¸åŒçš„è¾“å…¥å‚æ•°è¿›è¡Œæ ‡å‡†åŒ–å’Œç»Ÿä¸€ï¼Œä»¥ä¸€ç§é€šç”¨çš„ã€æ ‡å‡†åŒ–çš„æ–¹å¼ä¼ é€’ç»™ç³»ç»Ÿå†…éƒ¨çš„å„ä¸ªæ¨¡å—ã€‚è¿™ç§æ–¹æ³•æœ‰åŠ©äºï¼š\nå‡å°‘å†—ä½™ï¼šé¿å…æ¯ä¸ªæ¨¡å—éƒ½è®¾è®¡ç‹¬ç«‹çš„å‚æ•°ç»“æ„ï¼Œå‡å°‘é‡å¤çš„ä»£ç å’Œå†—ä½™çš„é€»è¾‘ã€‚ æé«˜å¯ç»´æŠ¤æ€§ï¼šé€šè¿‡ç»Ÿä¸€çš„å‚æ•°æ¥å£ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å®¹æ˜“åœ°ç†è§£å’Œç»´æŠ¤ä»£ç ã€‚ å¢å¼ºæ‰©å±•æ€§ï¼šå½“éœ€è¦å¢åŠ æ–°çš„åŠŸèƒ½æˆ–æ¨¡å—æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å·²ç»Ÿä¸€çš„å‚æ•°æ¥å£ï¼Œä¸éœ€è¦å¯¹ç°æœ‰çš„ç³»ç»Ÿåšå¤§çš„æ”¹åŠ¨ã€‚ æ€»ç»“ ç»Ÿå’Œå…¥å‚ æ˜¯ä¸€ç§åœ¨ç³»ç»Ÿè®¾è®¡ä¸­å¸¸ç”¨çš„ç­–ç•¥ï¼Œé€šè¿‡å°†å¤šä¸ªä¸åŒæ¥æºçš„è¾“å…¥å‚æ•°è¿›è¡Œç»Ÿä¸€å’Œæ•´åˆï¼Œå¯ä»¥ç®€åŒ–ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚è¿™ä¸ªæ¦‚å¿µç‰¹åˆ«é€‚ç”¨äºå¤§å‹ç³»ç»Ÿæˆ–è€…éœ€è¦å¤„ç†å¤šç§è¾“å…¥çš„åœºæ™¯ã€‚\n","date":"2024-08-22T00:00:00Z","image":"https://ap-developer-images.oss-cn-shanghai.aliyuncs.com/iOS/2024/20240822%E3%80%8ASwift%E5%88%A9%E7%94%A8%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E4%BC%98%E5%8C%96%E9%A1%B9%E7%9B%AE%E5%A4%9A%E8%AF%AD%E8%A8%80enum%E3%80%8B/banner.webp","permalink":"https://abnerpei.github.io/p/swift%E5%88%A9%E7%94%A8%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E4%BC%98%E5%8C%96%E9%A1%B9%E7%9B%AE%E5%A4%9A%E8%AF%AD%E8%A8%80enum/","title":"Swiftåˆ©ç”¨åè®®æ‰©å±•ä¼˜åŒ–é¡¹ç›®å¤šè¯­è¨€enum"},{"content":"å…³äº [weak self] å¤„ç†å¾ªç¯å¼•ç”¨ï¼Œåœ¨ä¹‹å‰çš„æ–‡ç«  åˆ«å†è¿™æ ·å†™äº†ï¼šguard let `self` = self else { return }ï¼Œè¿™ä¸ªbugå·²ç»ä¿®å¤äº†ï¼ å·²ç»æåˆ°ï¼š\n1 guard let `self` = self else { return } å¯ä»¥æ”¹ä¸ºï¼š\n1 guard let self = self else { return } from Swift 5.8 ä» Swift 5.8 å¼€å§‹ï¼Œ[weak self] åˆæœ‰äº†æ–°çš„å˜åŒ–ï¼Œå¦‚ä¸‹ï¼šself ä¹Ÿå¯ä»¥çœç•¥äº†ï¼\nbefore Swift 5.8 ä¸‹å›¾å‡ºè‡ªï¼šSwift 5.8 é€ƒé€¸é—­åŒ…ä¸­çœç•¥ self å…³é”®å­— ï¼ˆæ›´å¤šåˆ†æï¼Œä¹Ÿå¯çœ‹è¯¥åšæ–‡ï¼‰\nä»ä¸Šé¢æŠ¥é”™ä¿¡æ¯å¯ä»¥çœ‹å‡ºï¼ŒtestMethod2() å‰é¢è¿˜æ˜¯è¦åŠ ä¸Š self.ï¼Œä½†è¿™å·²æˆä¸ºè¿‡å»ï¼ŒSwift 5.8 åŠå…¶ä»¥åï¼Œå°±å¯ä»¥ä¸ç”¨åŠ  self. äº†ã€‚ å‚è€ƒé“¾æ¥ concise [weak self] Swift 5.8 é€ƒé€¸é—­åŒ…ä¸­çœç•¥ self å…³é”®å­— ","date":"2023-10-26T00:00:00Z","image":"https://ap-developer-images.oss-cn-shanghai.aliyuncs.com/iOS/2023/20231026-tips-%E7%AE%80%E6%B4%81%E7%9A%84%5Bweak%20self%5D/001.gif","permalink":"https://abnerpei.github.io/p/ios-weak-self-api/","title":"è¿›å‡»çš„ [weak self]"},{"content":"é¢ä¸´çš„é—®é¢˜ åœ¨ GBPartySocket å’Œ GBGlobalSocket ä¸­ï¼Œæ¯å¢åŠ ä¸€ç§ä¸šåŠ¡ Action ï¼ˆç»§æ‰¿è‡ªä¸€ä¸ªåŸºç±» Action ï¼‰ï¼Œå°±è¦åœ¨ didHandleMessageData(messageData: ) æ–¹æ³•ä¸­å¢åŠ å¦‚ä¸‹ä»£ç ï¼š\n1 2 3 4 if GBEscortCPAction.isCurrentAction(actionName) { let action = GBEscortCPAction() action.configType(with: actionName, jsonData: messageData) } å¦‚æ­¤ï¼Œç»è¿‡ä¸åœè¿­ä»£ï¼Œä¸Šé¢çš„ï¼ˆdidHandleMessageData(messageData:)ï¼‰ä»£ç å°±ä¼šå˜çš„è¶Šæ¥è¶Šå¤šï¼Œå¦‚ä¸‹å›¾éé«˜äº®åŒºåŸŸæ‰€ç¤ºï¼ˆé«˜äº®åŒºä¸ºç¬¬ä¸€æœŸæ”¹è¿›åçš„ï¼Œä¸‹æ–‡åè®²åˆ°ï¼‰ï¼ ä½†ç¢äºé¡¹ç›®ä¸€ç›´åœ¨ç´§é”£å¯†é¼“ä¸­è¿›è¡Œç€è¿­ä»£ï¼Œè™½ç„¶ä¸€ç›´æƒ³ç€å»æ”¹è¿›ï¼Œåˆæ²¡æœ‰åˆé€‚çš„æ€è·¯ï¼Œäºæ˜¯ä¸€æ¬¡åˆä¸€æ¬¡åœ°è·ƒè·ƒæ¬²è¯•ï¼Œåˆä¸€æ¬¡åˆä¸€æ¬¡åœ°æ”¾å¼ƒï¼ä½†ï¼Œä¸€åˆ‡åˆåœ¨å‰ä¸¤å¤©å‡ºç°äº†è½¬æœºï¼šé©¬ä¸Šä¸­ç§‹â•åä¸€æ”¾å‡ï¼ŒèŠ‚å‰çš„æœ€åä¸€æ¬¡è¿­ä»£ææµ‹åï¼Œæœ‰äº†ç‚¹ç©ºé—²æ—¶é—´ï¼ˆæµ‹è¯•æœ‰é—®é¢˜å°±æ”¹ä¸€æ”¹ï¼Œæ²¡é—®é¢˜å°±ä¸“å¿ƒæ”¹è¿›ï¼‰ï¼Œä¸€å¤´æ‰è¿›æ”¹è¿›ä¸­ï¼Œè¿ä¸‹ç­éƒ½åœ¨æƒ³æ€ä¹ˆæ”¹è¿›ï¼ˆå“ˆğŸ˜„å“ˆğŸ˜„å“ˆğŸ˜„ï¼‰ï¼Œç»è¿‡2æ¬¡çš„è°ƒæ•´ï¼Œæ€»ç®—æ˜¯æœ‰ä¸ªæ»¡æ„çš„ç»“æœï¼\nåˆ†æé—®é¢˜ï¼Œæ‰¾å‡†ç—›ç‚¹ æƒ³è¦è§£å†³é—®é¢˜ï¼Œä¸€å®šè¦å¼„æ¸…æ¥šé—®é¢˜çš„æ ¹æºï¼ˆç—›ç‚¹ï¼‰åœ¨å“ªï¼é¡¹ç›®ä¸­çš„ Socket æ¨é€ä¿¡æ¯ç»“æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæƒ³è¦è§£ææ•°æ®å¹¶åšå‡ºå“åº”ï¼Œå°±ä¸€å®šè¦ç°æ ¹æ® action åï¼Œç¡®å®šæ˜¯å“ªç§ä¸šåŠ¡åœºæ™¯ï¼Œå³ï¼šæ ¹æ® action åç¡®å®šè¦ç”¨å“ªä¸ª Action ç±»ï¼è¿™ä¸€ç‚¹ï¼Œå¤§å®¶éƒ½æ˜ç™½ï¼Œä¹Ÿå¤„ç†äº†ï¼Œä½†æ˜¯å¤„ç†çš„ä¸æ˜¯å¾ˆæ»¡æ„ï¼šæ¯å¢åŠ ä¸€ç§ä¸šåŠ¡ï¼Œå°±å¢åŠ ä¸Šé¢æåˆ°çš„ isCurrentAction æ–¹æ³•åˆ¤æ–­ï¼Œå¯¼è‡´ Socket ä¸­é‡å¤ä»£ç é¢‡å¤šã€‚ æœ‰æ²¡æœ‰ä¸€ç§è‡ªåŠ¨æ˜ å°„çš„æ–¹æ¡ˆå‘¢ï¼Ÿ æˆ‘ç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†åå°„ï¼šNSClassFromString ä»¥åŠ Mirror ï¼Œç»è¿‡è°ƒç ”ï¼Œå‘ç° NSClassFromString è¿˜æ˜¯æœ‰å¯èƒ½æ»¡è¶³çš„ï¼Œä½† Mirror å°±ä¸è¡Œã€‚\nNSClassFromString è™½ç„¶å¯è¡Œï¼Œä½†åˆä¸è¡Œ è¿™é‡Œè¯´è¡Œï¼Œæ˜¯å› ä¸ºä»ä»£ç å±‚é¢æ¥è¯´ï¼Œç¡®å®å¯è¡Œï¼ ä½†åˆä¸è¡Œï¼Œæ˜¯å› ä¸º action çš„åå­—æ²¡æœ‰æŒ‰ç…§ç»Ÿä¸€çš„æ ¼å¼è¿”å›ï¼Œæ¯•ç«Ÿé¡¹ç›®ä¸€å¼€å§‹æ²¡æœ‰è€ƒè™‘è¿‡è¿™ä¸ªï¼ˆApp ç«¯æ²¡æœ‰è€ƒè™‘è¿‡ã€åç«¯ä¹Ÿæ²¡æœ‰è€ƒè™‘è¿‡ï¼‰ï¼Œå¦‚ä»Šä¸ºäº† App ç«¯ï¼ˆ iOS ç«¯ï¼‰ï¼Œè®©åå°å†å»æŠŠæ‰€æœ‰çš„ action åå­—æŒ‰ç…§ç»Ÿä¸€çš„æ ¼å¼æ•´ç†ä¸€ä¸‹ï¼Œâ€œä¸å¯èƒ½ï¼Œç»å¯¹ä¸å¯èƒ½â€ï¼\n1 2 3 4 5 6 7 /// æˆ¿é—´æ–—åœ°ä¸»ä¸šåŠ¡çš„actionå \u0026#34;fight_landlord_start_mode.notice\u0026#34; \u0026#34;fight_landlord_close_mode.notice\u0026#34; /// å¼€é»‘CPä¸šåŠ¡çš„actionå \u0026#34;escort_cp.success\u0026#34; \u0026#34;escort_cp.upgrade\u0026#34; æƒ³è¦çš„ action å\n1 2 3 4 5 6 7 /// æˆ¿é—´æ–—åœ°ä¸»ä¸šåŠ¡çš„actionå \u0026#34;FightLandlord.start_mode.notice\u0026#34; \u0026#34;FightLandlord.close_mode.notice\u0026#34; /// å¼€é»‘CPä¸šåŠ¡çš„actionå \u0026#34;EscortCp.success.notice\u0026#34; \u0026#34;EscortCp.upgrade.notice\u0026#34; å¦‚æœåå°æ¨é€çš„ action åï¼ŒæŒ‰ç…§æƒ³è¦çš„ç»Ÿä¸€æ ¼å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¦‚ä¸‹å¤„ç†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 private func handle(name: String, data: PBMessageData?) { guard let actionClsName = name.components(separatedBy: \u0026#34;.\u0026#34;).last, !actionClsName.isEmpty else { return } guard let nameSpace = Bundle.main.infoDictionary![\u0026#34;CFBundleExecutable\u0026#34;] as? String else { assert(false, \u0026#34;âš ï¸ è¯·æ³¨æ„ï¼šè·å–å‘½åç©ºé—´å¤±è´¥\u0026#34;) return } guard let Cls: AnyObject.Type = NSClassFromString(\u0026#34;\\(nameSpace).\\(actionClsName)\u0026#34;) else { assert(false, \u0026#34;âš ï¸ è¯·æ³¨æ„ï¼šæ— æ³•æ ¹æ®actionç±»åå­—ç¬¦ä¸²è·å–å¯¹åº”çš„actionç±»\u0026#34;) return } guard let actionCls = Cls as? GBSocketAction.Type else{ assert(false, \u0026#34;âš ï¸ è¯·æ³¨æ„ï¼šæœªèƒ½æˆåŠŸè½¬æ¢æˆGBSocketActionç±»å‹\u0026#34;) return } let action = actionCls.init() action.configType(with: action, jsonData: data) } è§£å†³é—®é¢˜ ç¬¬ä¸€æœŸæ”¹è¿› æ‹ä¸€æ‹æ€è·¯ï¼š\nä¸€ä¸€åŒ¹é…ï¼šæ ¹æ® action åç¡®å®šè¦ç”¨å“ªä¸ª Handler ç±»ï¼Œå§‹ç»ˆæ˜¯é‡ç‚¹ï¼Œé¿ä¸å¼€è¦ä¸€ä¸€å»åŒ¹é…ï¼ action åå­—ç¬¦ä¸²åªå®šä¹‰ä¸€æ¬¡ï¼šä¸ºäº†æ–¹ä¾¿åŒ¹é… action åï¼Œå¯é‡‡ç”¨ let æ–¹å¼çš„ action åï¼Œæˆ–è€…æšä¸¾ç±»å‹çš„ action åï¼Œè¿™é‡Œé€‰æ‹©åè€…ã€‚ ä¸šåŠ¡ç‹¬ç«‹ï¼šå…¨å±€ç”¨ä¸€ä¸ª Handler ï¼Œåå°è¿”å›çš„æ‰€æœ‰ action åæ”¾åˆ°ä¸€ä¸ªç±»é‡Œï¼Œæ— è®º let æ–¹å¼çš„ action åï¼Œæˆ–è€…æšä¸¾ç±»å‹çš„ action åï¼Œéƒ½ä¸é‡è¦äº†ï¼Œä½†åˆå›åˆ°äº†æ ¹æœ¬é—®é¢˜ä¸Šï¼ŒHandler åˆå˜çš„æ— æ¯”å¤æ‚ï¼ å„ä¸ªè‡ªå®šä¹‰ Handler ç±»æœ‰å“ªäº›å…±åŒæ€§ï¼šå¤„ç†å„è‡ªç‹¬ç«‹çš„ä¸šåŠ¡é€»è¾‘ é‰´äºè¯¥æ€è·¯çš„æ€è€ƒå’Œä¸åœåœ°å°è¯•ï¼Œç¬¬ä¸€æœŸæ”¹è¿›ä»¥æšä¸¾åµŒå¥— + åè®®è½åœ°ï¼š 1.1 å£°æ˜åè®® + å®šä¹‰æšä¸¾ PBSocketHandlerProtocolï¼šå„ç§ Handler çš„ handle æ¨é€ä¿¡æ¯çš„åè®®ï¼Œç”±å„ä¸ªä¸šåŠ¡çš„ Handler ç±»éµå¾ªå¹¶å®ç° PBSocketGetHandlerProtocolï¼šè·å–å„è‡ªä¸šåŠ¡çš„å…·ä½“ Handler å®ä¾‹ HandlerProtocolï¼šPBSocketGetHandlerProtocol å’Œ CaseIterable ï¼ˆå…¶å®æ²¡ç”¨åˆ°ï¼‰ çš„åˆ«å 1.2 åˆ›å»ºé¢†å¯¼å‹ Handler å’Œ å‘˜å·¥å‹ Handler PBSocketHandler å’Œ PBBilliardsHandler ï¼šå‰è€…ç›¸å½“äºé¢†å¯¼ï¼Œåè€…ç›¸å½“äºå‘˜å·¥ï¼Œå½“æ¨é€æ¶ˆæ¯æ¥äº†ï¼Œé¢†å¯¼æ ¹æ® action åï¼Œæ‰¾åˆ°å…·ä½“å‘˜å·¥ï¼Œè®©è¯¥å‘˜å·¥å»å¤„ç†ã€‚ 1.3 ç¼–å†™ä»£ç  åˆ›å»º PBSocketNoticeScene æšä¸¾ï¼ˆè§ä¸Šå›¾ï¼‰ï¼Œå¹¶åœ¨å…¶ extension ä¸­åˆ›å»ºå„ç§ç»†åˆ†ä¸šåŠ¡çš„æšä¸¾ï¼Œè¿™é‡Œä»¥æ¡Œçƒæ¸¸æˆä¸šåŠ¡ä¸ºä¾‹ï¼Œå³ï¼šBilliards æšä¸¾ï¼Œå¹¶éµå¾ª HandlerProtocol åè®®ï¼Œhandler çš„è·å–åªæœ‰åœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰å»åˆ›å»ºï¼Œè§ä¸‹å›¾ï¼š å¯¹å…·ä½“ä¸šåŠ¡ Action ç±»æ”¹é€ ï¼šä¿®æ”¹ GBBilliardsAction (ç»§æ‰¿è‡ª GBSocketAction ) ä¸º PBBilliardsHandler (éµå®ˆ PBSocketHandlerProtocol ) è€ç‰ˆæœ¬çš„ä»£ç ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š ç¬¬äºŒæœŸæ”¹è¿› åœ¨ç¬¬ä¸€æœŸæ”¹è¿›ä¸­ï¼Œè¿˜æœ‰ä»¤äººä¸æ»¡æ„çš„é—®é¢˜ï¼š\nGBPartySocket ä¸­çš„ didHandleMessageData(messageData: ) é‡Œçš„ä¼—å¤š XXAction çš„ isCurrentAction: ï¼Œå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„æ”¹å–„ï¼Œåªæ˜¯è½¬ç§»åˆ°äº†æ‰€è°“çš„é¢†å¯¼å‹ PBSocketHandler ä¸­ï¼› PBSocketHandler ä¸­æ”¹åŠ¨å¤ªå¤šï¼Œæ¯å¢åŠ ä¸€ç§ä¸šåŠ¡çš„åŒæ—¶éœ€è¦æ–°å¢ä¸€ä¸ªåŒ¹é…åˆ¤æ–­å’Œä¸€ä¸ªä¸šåŠ¡ case ï¼Œä¾ç„¶æ¯”è¾ƒç¹çï¼Œå¹¶ä¸”è¿™ç§æ–¹æ¡ˆï¼Œå¼•å…¥äº†ä¸­é—´å•†ï¼ˆä¹Ÿå³ï¼šPBSocketHandlerï¼Œæ‰€è°“çš„é¢†å¯¼ï¼‰ é‚£å¦‚ä½•æ›´è¿›ä¸€æ­¥ä¼˜åŒ–å‘¢ï¼Ÿç»è¿‡åå¤åœ°æ€è€ƒä¸å°è¯•ã€åå¤åœ°å°è¯•ä¸æ€è€ƒï¼Œæœ¬ç€ä¸€ä¸ªèƒ½ç®€å•ç»ä¸éº»çƒ¦â•ä¸é‡å¤çš„åŸåˆ™ï¼Œè¿æ¥äº†ç¬¬äºŒæœŸçš„æ”¹è¿›ï¼Œç»ˆä»¤äººæ»¡æ„ï¼è¿™é‡Œè¿«ä¸åŠå¾…åœ°æƒ³å±•ç¤ºè¿™ä¸€æœŸçš„ç»“æœï¼š\n2.1 é¦–å…ˆï¼ŒPBPartySocket ä¸­çš„ didHandleMessageData(messageData:) æ–¹æ³•ï¼Œåªå‰©ä¸‹ 2 è¡Œä»£ç ï¼š 2.2 å£°æ˜SocketActProtocol åè®®ï¼Œç”¨äºå…·ä½“ä¸šåŠ¡ Action å¤„ç†ä¸šåŠ¡ è¯´æ˜ï¼šè¯¥åè®®ï¼Œä¸ä»…å…·ä½“çš„ä¸šåŠ¡ Action éµå¾ªï¼ŒPBPartySocket å’Œ PBGlobalSocket ä¹Ÿéµå¾ªï¼ˆè€Œè¿™é‡Œä¹Ÿæ˜¯ä¸ªå·§å¦™ä¹‹å¤„ï¼‰ã€‚\nSocketActProtocol 1 2 3 protocol SocketActProtocol { func act(_ name: String, data: PBMessageData?) } æ‰€è°“çš„å·§å¦™åˆ†æï¼šåœ¨ç¬¬ä¸€æœŸæ”¹è¿›ä¸­æåˆ°äº†é¢†å¯¼å‹ Handler å’Œå‘˜å·¥å‹ Handlerï¼Œåˆ°äº†ç¬¬äºŒæœŸæ”¹è¿›æ—¶ï¼Œæˆ‘å‘ç°é¢†å¯¼å‹ Handler æˆäº†è®¨äººåŒçš„â€œä¸­é—´å•†â€ï¼Œæ‰€ä»¥å½“ PBPartySocket æˆ–è€… PBGlobalSocket æ”¶åˆ°åå° Socket æ¨é€æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ SocketActProtocol çš„ act(_ ,data) æ–¹æ³•å¤„ç†ï¼Œè€Œè¿™ç›¸æ¯”äºå…·ä½“çš„ä¸šåŠ¡ Action çš„ act(_ ,data) æ–¹æ³•å¤„ç†ï¼ˆè¿™ä¸ªä¹Ÿï¼Œå…·ä½“è§ä¸‹æ–‡ï¼‰ï¼Œåªæ˜¯é‡Œé¢çš„å®ç°æ–¹å¼ä¸ä¸€æ ·ï¼\n2.3 å£°æ˜ SocketActionable åè®®ï¼Œç”¨äº Socket å­ç±»ï¼ˆå¦‚ï¼šGBPartySocket æˆ–è€… GBGlobalSocketï¼‰è·å–è‡ªå·±æ‰€æœ‰çš„ä¸šåŠ¡ Action ç±»å‹ï¼Œä»¥åŠè®©å…·ä½“çš„ä¸šåŠ¡ Action å®ä¾‹æ‰§è¡Œ Socket æ¨é€ä¿¡æ¯å¤„ç† SocketActionable 1 2 3 4 5 6 7 8 9 10 11 12 13 protocol SocketActionable: SocketActProtocol { var actions: [SocketAction.Type] { get } } extension SocketActionable { func act(_ name: String, data: PBMessageData?) { guard !actions.isEmpty else { return } guard let Action = actions.first(where: { $0.isHit(name)}) else { return } Action.action.act(name, data: data) } } ä¸Šæ–‡æåˆ° PBPartySocket ä¹Ÿéµå¾ª SocketActProtocolï¼Œå¯¹äº act(_, data:) æ–¹æ³•çš„å®ç°ï¼Œå¯ä»¥ç”¨ SocketActionable çš„ extension é»˜è®¤å®ç°ï¼Œå¦‚æ­¤ä¸‹æ¥ï¼Œåç»­å¦‚æœæœ‰æ–°çš„ä¸šåŠ¡éœ€æ±‚ï¼Œåªéœ€è¦å®šä¹‰å¯¹åº”çš„ä¸šåŠ¡ Action ï¼Œå¹¶åœ¨ GBPartySocket æˆ–è€… GBPartySocket ä¸­çš„ actions çš„ getter å±æ€§ä¸­æ–°å¢å¦‚ä¸‹ä»£ç å³å¯ï¼ˆ æ€»ç»“ï¼šè¿™é‡Œåªéœ€è¦å¢åŠ 1 è¡Œä»£ç ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 extension PBPartySocket: SocketActionable { var actions: [SocketAction.Type] { [ RoomMagicAction.self, BilliardsAction.self, EscortCPAction.self ] } } 2.4 å£°æ˜ SocketActionProtocol åè®®ï¼Œç”¨äºè·å– action åå¯¹åº”çš„ä¸šåŠ¡ Action è·å–åˆ° names å°±å¯ä»¥é€šè¿‡ SocketActionProtocol çš„æ‰©å±•å®ç° isHit æ–¹æ³•\nSocketActionProtocol 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 protocol SocketActionProtocol { static var names: [String] { get } static func isHit(_ name: String) -\u0026gt; Bool static var action: SocketActProtocol { get } } extension SocketActionProtocol { static func isHit(_ name: String) -\u0026gt; Bool { let names = self.names guard !name.isEmpty, !names.isEmpty else { return false } return names.contains(name) } } ä¸šåŠ¡ Action çš„æ ¸å¿ƒå½“ç„¶è¿˜æ˜¯è¦å¤„ç† Socket æ¨é€ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸šåŠ¡ Action è¦åŒæ—¶éµå®ˆ SocketActionProtocol å’Œ SocketActProtocolï¼Œè¿™é‡Œé‡‡ç”¨åˆ«åå½¢å¼åŠ ä»¥æ•´ç†ï¼š\nSocketAction 1 typealias SocketAction = SocketActionProtocol \u0026amp; SocketActProtocol 2.5 å£°æ˜å…·ä½“ä¸šåŠ¡ Action ï¼Œå¹¶å®ç°ç›¸å…³åè®® ç¤ºä¾‹ EscortCPAction å®šä¹‰ EscortCPAction ç»“æ„ä½“ï¼Œå¹¶åµŒå¥— EscortCP: String, CaseIterable å’Œ RoomQuality: String, CaseIterable æšä¸¾ ï¼ˆè¿™é‡Œä¹Ÿå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªæšä¸¾ï¼Œä½†ä¸ªäººæ›´å–œæ¬¢å„è‡ªä¸šåŠ¡ç»†åˆ†ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 /// å¼€é»‘CPæ¨é€ \u0026amp; å¼€é»‘æˆ¿è´¨é‡å·®å…³æ’­é€šçŸ¥ struct EscortCPAction { enum EscortCP: String, CaseIterable { /// åŸæœ‰çš„`escort_cp.request`ï¼ˆå·²åˆ é™¤ï¼‰æ–°ä»£ç ä¸Šå»åå°±ä¸æ¨é€äº† case escort_cp_request_v2 = \u0026#34;escort_cp.request.v2\u0026#34; /// ç»„æˆCPæ¨é€ case escort_cp_success = \u0026#34;escort_cp.success\u0026#34; /// CPå‡çº§æ¨é€ case escort_cp_upgrade = \u0026#34;escort_cp.upgrade\u0026#34; /// é™ªé™ªcpè¿›è¡Œå®˜å®£cpç‰¹æ•ˆæ¨é€ï¼ˆæ¨é€ç›®æ ‡ï¼šå…¨å¹³å°æ‰€æœ‰æˆ¿é—´å†…çš„ç”¨æˆ·ï¼‰ case escort_cp_official_announce_notice = \u0026#34;escort_cp_official_announce.notice\u0026#34; /// è¿éº¦æ—¶é•¿è¾¾æ ‡åé‚€è¯·è¿›å…¥å®¶æ—æ¨é€ case escort_family_invite_join_online_mic = \u0026#34;escort_family.invite_join.online_mic\u0026#34; } enum RoomQuality: String, CaseIterable { /// å¼€é»‘æˆ¿è´¨é‡å·®[å…³æ’­]é€šçŸ¥ case gang_up_room_quality_punish_notice = \u0026#34;gang_up_room_quality_punish.notice\u0026#34; /// å¼€é»‘æˆ¿è´¨é‡å·®[è­¦å‘Š]é€šçŸ¥ case gang_up_room_quality_warn_notice = \u0026#34;gang_up_room_quality_warn.notice\u0026#34; } } æ‰©å±• EscortCPAction ï¼Œå¹¶éµå¾ª SocketAction â‘  å®ç° SocketActionProtocol ä¸­çš„ names å’Œ action â‘¡ å®ç° SocketActProtocol ä¸­çš„ act(_, data:) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 extension EscortCPAction: SocketAction { static var names: [String] { EscortCP.allCases.map({ $0.rawValue }) + RoomQuality.allCases.map({ $0.rawValue }) } static var action: SocketActProtocol { Self.init() } func act(_ name: String, data: PBMessageData?) { guard let data = data else { return } act(ec: enumName, data: data) } else if let enumName = RoomQuality(rawValue: name) { act(rq: enumName, data: data) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 extension EscortCPAction { fileprivate func act(ec: EscortCP, data: PBMessageData) { if ec == .escort_cp_request_v2 { /// å¤„ç†ä¸šåŠ¡ } else if ec == .escort_cp_success { /// å¤„ç†ä¸šåŠ¡ } /// ... other } fileprivate func act(rq: RoomQuality, data: PBMessageData) { if rq == .gang_up_room_quality_punish_notice { /// å¤„ç†ä¸šåŠ¡ } else if rq == .gang_up_room_quality_warn_notice { /// å¤„ç†ä¸šåŠ¡ } } } æ€»ç»“ åˆ›å»ºä¸šåŠ¡ Action ç±»ï¼Œå¹¶éµå®ˆå¹¶å®ç° SocketAction åè®® åœ¨å¯¹åº”çš„ Socket ç±»ä¸­çš„ SocketActionable åè®®çš„ä¸­ actions æ–°å¢ä¸Šé¢çš„ Action åœ¨ä¸šåŠ¡ Action ç±»ä¸­çš„ act(_, data: ) æ–¹æ³•ä¸­å¤„ç†å…·ä½“ä¸šåŠ¡ æœ€åï¼Œæ•´ç†é‡Œä¸€ä¸‹å¤§æ¦‚æµç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š ","date":"2023-09-28T00:00:00Z","image":"https://ap-public-blog.oss-cn-shanghai.aliyuncs.com/my-hugo-blog/content/post/iOS/ProjectExperience/EP/20230928%20-%20%E5%85%B3%E4%BA%8ESocket%E6%8E%A8%E9%80%81%E5%A4%84%E7%90%86%E7%9A%84%E6%94%B9%E8%BF%9B/20230928.jpg","permalink":"https://abnerpei.github.io/p/%E5%85%B3%E4%BA%8Esocket%E6%8E%A8%E9%80%81%E5%A4%84%E7%90%86%E7%9A%84%E6%94%B9%E8%BF%9B/","title":"å…³äºSocketæ¨é€å¤„ç†çš„æ”¹è¿›"},{"content":"è®¾ç½®ç¬¦å·æ–­ç‚¹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š\nStyle 1ã€Breakpoint navigator Style 2ã€Debug -\u0026gt; Breakpoints -\u0026gt; Create Symbolic Breakpoint... Style 3ã€å¿«æ·é”®ï¼šoption + command + \\ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼\n","date":"2023-06-06T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2021/20210502.jpeg","permalink":"https://abnerpei.github.io/p/20230606/","title":"è®¾ç½®ç¬¦å·æ–­ç‚¹ï¼ˆSymbolic Breakpointï¼‰çš„å‡ ç§æ–¹å¼"},{"content":"åœ¨Swift 4.2ä¹‹å‰ï¼Œself æ˜¯å…¨å±€ä¿ç•™å…³é”®å­—ï¼Œæ‰€ä»¥å¦‚æœåœ¨é€ƒé€¸é—­åŒ…ä¸­æŠŠ self æ ‡è®°ä¸º weak åï¼Œè¿˜æƒ³ç»§ç»­ä½¿ç”¨ self å°±éœ€è¦ä½¿ç”¨ä¸¤ä¸ª ` å°†Â self åŒ…èµ·æ¥ï¼š\n1 guard let `self` = self else { return } è€Œåœ¨ Swift 4.2 ä¹‹åï¼ŒåŸºäº Allow using optional binding to upgradeÂ selfÂ from a weak to strong reference ææ¡ˆï¼Œå¯é€‰ç»‘å®šä¸­çš„ self ä¸å†ä½œä¸ºä¿ç•™å…³é”®å­—ã€‚æˆ‘ä»¬å®Œå…¨å¯ä»¥å…‰æ˜æ­£å¤§çš„è¿™ä¹ˆå†™äº†ï¼š\n1 guard let self = self else { return } å‚è€ƒé“¾æ¥ Swift Tips 022 Allow using optional binding to upgradeÂ guard let `self` = self else { return } is a bug ","date":"2022-09-05T00:00:00Z","image":"https://ap-public-blog.oss-cn-shanghai.aliyuncs.com/my-hugo-blog/content/post/iOS/SwiftNotes/20220905%20-%20%E5%88%AB%E5%86%8D%E8%BF%99%E6%A0%B7%E5%86%99%E4%BA%86%EF%BC%9Aguard%20let%20%60self%60%20%3D%20self%20else%20%7B%20return%20%7D%EF%BC%8C%E8%BF%99%E4%B8%AAbug%E5%B7%B2%E7%BB%8F%E4%BF%AE%E5%A4%8D%E4%BA%86%EF%BC%81/20221006.jpg","permalink":"https://abnerpei.github.io/p/%E5%88%AB%E5%86%8D%E8%BF%99%E6%A0%B7%E5%86%99%E4%BA%86guard-let-self-self-else-return-%E8%BF%99%E4%B8%AAbug%E5%B7%B2%E7%BB%8F%E4%BF%AE%E5%A4%8D%E4%BA%86/","title":"åˆ«å†è¿™æ ·å†™äº†ï¼šguard let `self` = self else { return }ï¼Œè¿™ä¸ªbugå·²ç»ä¿®å¤äº†ï¼"},{"content":"ä¸€ã€ä¸‹è½½Flutter SDK 1. å»Flutterå®˜ç½‘ä¸‹è½½æœ€æ–°å®‰è£…åŒ… 2. é…ç½®Flutter SDKåˆ°æŒ‡å®šç›®å½• äºŒã€é…ç½®Flutterå¼€å‘ç¯å¢ƒ ã€æ³¨æ„ã€‘ å¦‚æœMacæ²¡æœ‰å®‰è£…Homebrew,å¯é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å®‰è£…ï¼š\n1 /usr/bin/ruby -e \u0026#34;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\u0026#34; æ£€æŸ¥Homebrewç‰ˆæœ¬ï¼š\n1 2 3 4 5 6 7 brew --version /* Homebrew 3.2.16 Homebrew/homebrew-core (git revision f7d7160e185; last commit 2021-10-12) Homebrew/homebrew-cask (git revision d101c8d60c; last commit 2021-10-12) */ 2.1ã€è¿›å…¥ç”¨æˆ·homeç›®å½• 1 cd ~/ 2.2ã€æ‰“å¼€.bash_profileå¹¶ç¼–è¾‘ 1 open .bash_profile åœ¨.bash_profileä¸­æ·»åŠ ï¼š\n1 2 3 4 5 # Flutter export PUB_HOSTED_URL=https://pub.flutter-io.cn export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn export PATH=/Users/peijianbo/Documents/Flutter/flutter/bin:$PATH # Flutter END ã€æé†’ã€‘ å…¶ä¸­/Users/klcw/peijianbo/Flutter/flutteræ˜¯æˆ‘è‡ªå·±ç”µè„‘å¯¹åº”çš„Flutter SDKçš„ç›®å½•ï¼Œä½ éœ€è¦ä¿®æ”¹ä¸ºä½ çš„Flutter SDKå¯¹åº”çš„ç›®å½•ã€‚\nã€æ³¨æ„ã€‘ é™¤äº†exportåæœ‰ä¸ªç©ºæ ¼ï¼Œå…¶å®ƒåœ°æ–¹ä¸è¦æœ‰ç©ºæ ¼ã€‚\n2.3ã€command + sä¿å­˜ä¿®æ”¹å¹¶å…³é—­.bash_profile 2.4ã€ä»¤ä¿®æ”¹åçš„é…ç½®ç”Ÿæ•ˆ 1 source .bash_profile 2.5ã€æ£€æŸ¥Flutterå¼€å‘ç¯å¢ƒæ˜¯å¦å¯ç”¨ 1 flutter doctor å‡ºç°å¦‚ä¸Šå›¾çš„ç»ˆç«¯ï¼Œå°±è¯´æ˜Flutterçš„å¼€å‘ç¯å¢ƒé…ç½®æˆåŠŸäº†ã€‚\n","date":"2022-04-09T00:00:00Z","image":"https://ap-public-blog.oss-cn-shanghai.aliyuncs.com/my-hugo-blog/content/post/Flutter/20220409%20-%20Mac%E4%B8%8AFlutter%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/20220409.jpeg","permalink":"https://abnerpei.github.io/p/flutter-config/","title":"Macä¸ŠFlutterå¼€å‘ç¯å¢ƒé…ç½®"},{"content":"æˆªæ­¢ç›®å‰ï¼ˆ2021-10-16ï¼‰ä¸ºæ­¢ï¼Œè¦æƒ³å®ç°ä¸‹é¢çš„å‡ ç§ button æ ·å¼ï¼ˆè¿™é‡Œè¦è€ƒè™‘å›¾ç‰‡å’Œæ–‡å­—é—´è·ï¼‰ï¼Œæˆ‘æ‰€çŸ¥é“çš„æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š\nç»™ UIButton æ·»åŠ åˆ†ç±»\nè‡ªå®šä¹‰ UIButton\nè€Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ æ–¹æ¡ˆ1 åº”è¯¥æ˜¯æœ€å¤šçš„ï¼\nè‡ªæˆ‘å‚åŠ å·¥ä½œï¼ˆ2015-06ï¼‰ä»¥æ¥ï¼Œå¯¹äº UIButton å¦‚ä¸Šå›¾çš„éœ€æ±‚å°±ä¸€ç›´æœ‰ï¼Œè€Œä¸”è¿˜æœ‰å¾ˆå¤šï¼è¯´å®è¯ï¼Œæˆ‘ä¹Ÿä¸€ç›´å›°æƒ‘ï¼Œè‹¹æœçˆ¸çˆ¸é—®ä»€ä¹ˆä¸æ”¯æŒä¸€ä¸‹å‘¢ï¼Ÿ\nä¹Ÿè®¸æ˜¯æœ‰äººä¸åœåœ°ç»™è‹¹æœçˆ¸çˆ¸æ issue ï¼Œ ä¹Ÿè®¸æ˜¯è‹¹æœçˆ¸çˆ¸ä¹Ÿé‡åˆ°å¤§é‡çš„å¦‚æ­¤éœ€æ±‚ï¼Œ ä¹Ÿè®¸è‹¹æœçˆ¸çˆ¸åšäº†ç»Ÿè®¡å‘ç°å‡ ä¹æ‰€æœ‰ APP éƒ½æœ‰ UIButton è¿™ç±» Categroyï¼ˆSwiftæ˜¯ Extensionï¼‰, ä¹Ÿè®¸è‹¹æœçˆ¸çˆ¸ç»ˆäºé—²äº†æœ‰æ—¶é—´ç®¡äº†ï¼Œ ä¹Ÿè®¸\u0026hellip;ï¼Œ ä¸ç®¡æ€ä¹ˆè¯´ï¼ŒiOS15ï¼Œè‹¹æœçˆ¸çˆ¸æ”¯æŒäº†ï¼è€Œä¸”APIä¹Ÿå¦‚é¢„æœŸçš„é‚£æ ·ç®€å•ï¼š\n1 2 3 4 5 6 var conf = UIButton.Configuration.borderedTinted() /// è®¾ç½®å›¾ç‰‡çš„æ‘†æ”¾ï¼ˆå›¾ç‰‡åœ¨ä¸Šï¼Œåˆ™æ–‡å­—åœ¨ä¸‹ï¼‰ conf.imagePlacement = .top /// è®¾ç½®å›¾ç‰‡å’Œæ–‡å­—çš„é—´è· conf.imagePadding = 10 let bt = UIButton.init(configuration: conf, primaryAction: nil) æ’ä¸€å¥ï¼šå¯¹äº configuration è¿™æ ·çš„ API è®¾è®¡ï¼Œæˆ‘æ˜¯éå¸¸è®¤å¯çš„ï¼Œä¸€çœ‹å°±çŸ¥é“æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼æ„Ÿè§‰è‹¹æœçˆ¸çˆ¸ä¹Ÿæœ‰æ„å¦‚æ­¤è®¾è®¡ï¼Œæ¯”å¦‚ iOS14 å¼€å§‹çš„çš„ PHPickerConfiguration ç­‰ã€‚\nè€Œæˆ‘èƒ½å‘ç°è¿™ä¸ªï¼Œæºè‡ªä»Šå¤©ï¼ˆ2021-10-16ï¼‰ä¸‹åˆï¼Œæ‰“ç®—ç”¨ Swift é‡å†™è€é¡¹ç›®ï¼ˆã€Šé…·ä¹æ½®ç©ã€‹ï¼‰çš„ä¸€ä¸ªæ¨èåˆ—è¡¨é¡µï¼Œå…¶ä¸­ cell ä¸Šæœ‰å¦‚ä¸‹å‡ ä¸ªæŒ‰é’®ï¼Œæˆ‘æƒ³å‚è€ƒ OC å†™çš„ UIButton çš„ category ï¼Œä¹Ÿå†™ä¸ª Swift ç‰ˆçš„ï¼š\nå¯æ˜¯ï¼Œåœ¨æ•² titleedg æ—¶ï¼Œç«Ÿæç¤º 'titleEdgeInsets' will be deprecated in iOS 15.0 ã€‚è¿™ç¬é—´æ¿€èµ·äº†æˆ‘çš„å…´è¶£ï¼Œäºæ˜¯ç‚¹å‡»è¿›å»ä¸€æ¢ç©¶ç«Ÿï¼\nSwift ç‰ˆ UIButtonConfigurationï¼š Objective-C ç‰ˆ UIButtonConfigurationï¼š äºæ˜¯ï¼Œæˆ‘ç²—ç•¥åœ°å†™äº†ä¸ª demo éªŒè¯ä¸€ä¸‹ï¼Œæœ€ç»ˆæ•ˆæœå›¾ï¼š\nå…·ä½“ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 class ViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() // Do any additional setup after loading the view. view.backgroundColor = .white test() } func test() { var conf1 = UIButton.Configuration.plain() conf1.title = \u0026#34;ç‚¹èµ\u0026#34; conf1.image = UIImage(named: \u0026#34;liked\u0026#34;) conf1.imagePlacement = .leading conf1.imagePadding = 10 let bt1 = UIButton.init(configuration: conf1, primaryAction: nil) var conf2 = UIButton.Configuration.bordered() conf2.title = \u0026#34;ç‚¹èµ\u0026#34; conf2.image = UIImage(named: \u0026#34;liked\u0026#34;) conf2.imagePlacement = .trailing conf2.imagePadding = 40 let bt2 = UIButton.init(configuration: conf2, primaryAction: nil) var conf3 = UIButton.Configuration.borderedTinted() conf3.title = \u0026#34;ç‚¹èµ\u0026#34; conf3.image = UIImage(named: \u0026#34;liked\u0026#34;) conf3.imagePlacement = .top conf3.imagePadding = 10 let bt3 = UIButton.init(configuration: conf3, primaryAction: nil) var conf4 = UIButton.Configuration.gray() conf4.title = \u0026#34;ç‚¹èµ\u0026#34; conf4.image = UIImage(named: \u0026#34;liked\u0026#34;) conf4.imagePlacement = .bottom conf4.imagePadding = 10 let bt4 = UIButton.init(configuration: conf4, primaryAction: nil) bt1.frame = CGRect(x: 50, y: 100, width: 100, height: 80) bt2.frame = CGRect(x: 200, y: 100, width: 150, height: 80) bt3.frame = CGRect(x: 50, y: 230, width: 100, height: 80) bt4.frame = CGRect(x: 200, y: 230, width: 100, height: 80) view.addSubview(bt1) view.addSubview(bt2) view.addSubview(bt3) view.addSubview(bt4) } } æœ€åï¼Œè¯åˆè¯´å›æ¥äº†ï¼Œç›®å‰æˆ‘ä»¬çš„ APP ä¸å¯èƒ½æ˜¯ä» iOS15 å¼€å§‹çš„ï¼Œä¼°è®¡å¤§å¤šæ•°æ˜¯ä» iOS11 å¼€å§‹çš„ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æ˜¯ä» iOS9 å¼€å§‹ï¼Œä¹Ÿæœ‰ä¸€éƒ¨åˆ†æ˜¯ä» iOS13 å¼€å§‹çš„ï¼Œæ‰€ä»¥ åšå¥½å…¼å®¹è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼\nè€Œæ›´å¤šå…³äº UIButton çš„æ–°çŸ¥ï¼Œè¯·è‡ªè¡ŒæŸ¥çœ‹ API å­¦ä¹ ï¼Œæ€»ä½“æ„Ÿè§‰ï¼šUIButtonæ›´ä¸°å¯Œå¤šå½©äº† ï¼\n","date":"2021-10-16T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2021/20211016.jpeg","permalink":"https://abnerpei.github.io/p/ios-ios15-uibutton-update-api/","title":"iOS15ç»ˆäºè¿æ¥äº†UIButtonçš„è¿™ä¸ªæ”¹åŠ¨ï¼"},{"content":"ç¬¬â‘ æ­¥ï¼šé€šè¿‡npmå®‰è£…docsify 1 npm i docsify-cli -g ç¬¬â‘¡æ­¥ï¼šæ–°å»ºä¸€ä¸ªGitHubä»“åº“,å¹¶å¼€å¯GitHub Pages ç‚¹å‡»Saveåï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\nâš ï¸æ³¨æ„ï¼šæˆ‘è¿™é‡Œæ˜¾ç¤ºabnerpei.com/docsify/æ˜¯å› ä¸ºæˆ‘æœ‰åŸŸåè§£æå¤„ç†ï¼Œæ­£å¸¸çš„åº”è¯¥æ˜¯github.io/docsify/ã€‚\næ­¤æ—¶ï¼Œæˆ‘çš„é‚®ç®±ï¼ˆGitHubç»‘å®šçš„ï¼‰æ”¶åˆ°ä¸€å°é‚®ä»¶é€šçŸ¥\u0026quot;[AbnerPei/docsify]Page build failure\u0026quot;:\nç¬¬â‘¢æ­¥ï¼šcloneé¡¹ç›®ï¼Œå¹¶åˆ›å»ºdocsæ–‡ä»¶å¤¹ï¼š 1 docsify init ./docs æœ¬åœ°éªŒè¯ä¸€ä¸‹ï¼š\n1 docsify serve ./docs ç¬¬â‘£æ­¥ï¼šé…ç½®docsify ä¸‹è½½qufei1993/Nodejs-Roadmap æ‰¾åˆ°docsç›®å½•ï¼Œç„¶åå¯¹ç…§NodejsæŠ€æœ¯æ ˆï¼Œé…ç½®è‡ªå·±çš„docsifyã€‚\nç¬¬â‘¤æ­¥ï¼špushé¡¹ç›®ï¼ŒæŸ¥çœ‹æ•ˆæœ ä¸Šå›¾æŠ¥é”™è§£å†³åŠæ³•ï¼š\nremote/ Support for password authentication was removed on August 13, 2021\nå‚è€ƒé“¾æ¥ Docsifyå¿«é€Ÿæ­å»ºä¸ªäººåšå®¢ å®˜æ–¹æ–‡æ¡£-å¿«é€Ÿå¼€å§‹ ","date":"2021-09-23T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2021/20210923.jpeg","permalink":"https://abnerpei.github.io/p/20210923/","title":"åˆ©ç”¨docsifyå¿«é€Ÿåˆ›å»ºä¸ªäººåšå®¢"},{"content":"å‘¨æœ«åœ¨å®¶ï¼Œå¤©å…¬ä¸åšç¾ï¼Œå¤§é›¨ï¼æ‰€ä»¥ï¼Œå°±ä¼˜åŒ–ä¸€ä¸‹ä¹‹å‰çš„ä¸€ä¸ªå¼€æºåº“PPMakerï¼Œå¯æ˜¯åœ¨æäº¤çš„æ—¶å€™ï¼Œå°±é‡åˆ°äº†å¦‚ä¸‹çš„é—®é¢˜ï¼š\nä¸è¿‡ï¼Œåº†å¹¸çš„æ˜¯ï¼Œåˆšå¥½åœ¨æˆ‘æœè¿™ä¸ªé—®é¢˜2å°æ—¶å‰ï¼Œæœ‰äººç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼š\nã€GitHubä¸å†æ”¯æŒå¯†ç éªŒè¯è§£å†³æ–¹æ¡ˆï¼šSSHå…å¯†ä¸Tokenç™»å½•é…ç½®ã€‘\næ–‡ä¸­ç»™å‡ºäº†3ç§æ–¹æ¡ˆï¼Œæˆ‘é€‰æ‹©äº†ç¬¬3ç§ï¼š\nç¬¬â‘ æ­¥ï¼šå‰å¾€GitHubï¼Œå¤åˆ¶SSHçš„url\nç¬¬â‘¡æ­¥ï¼šæ‰¾åˆ°PPMakeræœ¬åœ°ç›®å½•ä¸‹çš„configæ–‡ä»¶\nç¬¬â‘¢æ­¥ï¼šæŠŠHTTPSçš„urlæ›¿æ¢æˆSSHçš„url\næœ€åï¼ŒæˆåŠŸäº†\n","date":"2021-08-15T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2021/20210815.jpeg","permalink":"https://abnerpei.github.io/p/20210815/","title":"gitæŠ¥é”™ï¼šremote/ Support for password authentication was removed on August 13, 2021çš„è§£å†³åŠæ³•"},{"content":"å°å®éªŒ 1 @property (nonatomic, assign) NSInteger age; ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœæ˜¯ä½ ï¼Œä½ å¹³æ—¶æ€ä¹ˆåœ¨ Xcode ä¸­æ•²å†™çš„å‘¢ï¼Ÿ\nç¬¬ä¸€ç§ï¼šä»å·¦åˆ°å³ä¾æ¬¡æ•²å†™\nç¬¬äºŒç§ï¼šé‡‡ç”¨Code Snippet\né€šè¿‡æˆ‘ä»¬çš„è‚‰çœ¼è§‚å¯Ÿï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„å‘ç°ï¼šç¬¬äºŒç§æ˜æ˜¾æ›´å¿«ã€‚\nçœ¼è§ä¸ºè™šï¼Œé‚£å¥½ï¼Œæˆ‘ä»¬ç”¨æ•°æ®æ¥è¯´è¯ï¼ˆæ§åˆ¶å˜é‡æ³• + å½•å±ï¼‰ï¼š\nå”¯ä¸€ä¸å¯æ§çš„æ˜¯æˆ‘åœ¨æ•²ä»£ç æ—¶çš„ååº”ï¼Œæš‚ä¸”å¿½ç•¥ä¸è®¡ã€‚\nç¬¬ä¸€ç§ç”¨æ—¶ 14ç§’ï¼Œç¬¬äºŒç§ç”¨æ—¶åŠ 3ç§’ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå·®åˆ«è¿˜æ˜¯å¾ˆå¤§çš„ï¼ˆè¯´å®åœ¨çš„ï¼Œæˆ‘è‡ªå·±ä¹‹å‰ä¹Ÿä¸€ç›´è§‰å¾—ç¬¬äºŒç§æ•ˆç‡æ›´é«˜ï¼Œä½†æ˜¯æ²¡æƒ³è¿‡å¦‚æ­¤ä¹‹é«˜ï¼‰ã€‚\nä»£ç å—ï¼ˆCode Snippetï¼‰ ä»£ç å—ï¼ˆCode Snippetï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªä»£ç ç‰‡æ®µã€‚\nCodeSnippets çš„æ–‡ä»¶è·¯å¾„ï¼š\n1 ~/Library/Developer/Xcode/UserData/CodeSnippets å¦‚ä½•è‡ªå®šä¹‰ä»£ç å— åˆ›å»ºä»£ç å— æ³¨æ„ä¸‹å›¾åœˆä¸­ï¼Œå¯¹åº”çš„é¢œè‰²ï¼ˆå·¦è¾¹æ˜¯æ•²ä»£ç æ—¶å±•ç¤ºçš„æ•ˆæœï¼Œå³è¾¹æ˜¯ä»£ç å—çš„é…ç½®ï¼‰ã€‚\nè¿™é‡Œæ³¨æ„è¦é€‰æ‹©Objective-Cï¼ˆé»˜è®¤æ˜¯Objective-C++ï¼‰ï¼Œå¦åˆ™æ‰©å±•ï¼ˆextensionï¼‰ä¸­æ— æ•ˆã€‚\nç³»ç»Ÿæä¾›çš„ä»£ç å— dispatch_onceã€dispatch_after 1 2 3 4 5 6 7 8 9 static dispatch_once_t onceToken; dispatch_once(\u0026amp;onceToken, ^{ \u0026lt;#code to be executed once#\u0026gt; }); return YES; dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(\u0026lt;#delayInSeconds#\u0026gt; * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{ \u0026lt;#code to be executed after a specified delay#\u0026gt; }); forã€for...in... 1 2 3 4 5 6 7 for (\u0026lt;#initialization#\u0026gt;; \u0026lt;#condition#\u0026gt;; \u0026lt;#increment#\u0026gt;) { \u0026lt;#statements#\u0026gt; } for (\u0026lt;#type *object#\u0026gt; in \u0026lt;#collection#\u0026gt;) { \u0026lt;#statements#\u0026gt; } è‡ªå®šä¹‰çš„ä»£ç å— æ ¼å¼ï¼š\u0026lt;#æ³¨é‡Š#\u0026gt;\nå±æ€§ å…³é”®å­—å±æ€§\n1 2 3 4 5 6 7 8 9 @property (nonatomic, strong) \u0026lt;#ClassName#\u0026gt; *\u0026lt;#propertyName#\u0026gt;; /// \u0026lt;#æ³¨é‡Š#\u0026gt; @property (nonatomic, strong) \u0026lt;#ClassName#\u0026gt; *\u0026lt;#propertyName#\u0026gt;; @property (nonatomic, assign) \u0026lt;#TypeName#\u0026gt; \u0026lt;#propertyName#\u0026gt;; /// \u0026lt;#æ³¨é‡Š#\u0026gt; @property (nonatomic, assign) \u0026lt;#TypeName#\u0026gt; \u0026lt;#propertyName#\u0026gt;; å…·ä½“å±æ€§\n1 2 3 4 5 6 7 8 9 @property (nonatomic, strong) UILabel *\u0026lt;#XX#\u0026gt;Label; /// \u0026lt;#æ³¨é‡Š#\u0026gt; @property (nonatomic, strong) UILabel *\u0026lt;#XX#\u0026gt;Label; @property (nonatomic, copy) NSString *\u0026lt;#propertyName#\u0026gt;; /// \u0026lt;#æ³¨é‡Š#\u0026gt; @property (nonatomic, copy) NSString *\u0026lt;#propertyName#\u0026gt;; æ‡’åŠ è½½ UILabel/UIImageViewç­‰çš„æ‡’åŠ è½½\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 - (UILabel *)\u0026lt;#yourLabel#\u0026gt; { if (!_\u0026lt;#yourLabel#\u0026gt;) { _\u0026lt;#yourLabel#\u0026gt; = [[UILabel alloc] init]; } return _\u0026lt;#yourLabel#\u0026gt;; } - (UIImageView *)\u0026lt;#yourImageView#\u0026gt; { if (!_\u0026lt;#yourImageView#\u0026gt;) { _\u0026lt;#yourImageView#\u0026gt; = [[UIImageView alloc] init]; } return _\u0026lt;#yourImageView#\u0026gt;; } NSArray/NSMutableArrayæœ‰æ³›å‹çš„æ‡’åŠ è½½\n1 2 3 4 5 6 7 - (NSMutableArray\u0026lt;\u0026lt;#GenericsName#\u0026gt; *\u0026gt; *)\u0026lt;#yourMArray#\u0026gt; { if (!_\u0026lt;#yourMArray#\u0026gt;) { _\u0026lt;#yourMArray#\u0026gt; = [NSMutableArray array]; } return _\u0026lt;#yourMArray#\u0026gt;; } NSArray/NSMutableArrayæ— æ³›å‹çš„æ‡’åŠ è½½\n1 2 3 4 5 6 7 - (NSMutableArray *)\u0026lt;#yourMArray#\u0026gt; { if (!_\u0026lt;#yourMArray#\u0026gt;) { _\u0026lt;#yourMArray#\u0026gt; = [NSMutableArray array]; } return _\u0026lt;#yourMArray#\u0026gt;; } æ–¹æ³•è°ƒç”¨ delegateå…ˆåˆ¤æ–­å†æ‰§è¡Œ Masonryä½¿ç”¨ å…¶å®ƒï¼ˆEvery or any, if you want!ï¼‰ ä»£ç å—çš„ä¼˜ç‚¹ é¿å…é‡å¤ä»£ç åå¤æ•²å†™ï¼Œå‡å°‘ä¸å¿…è¦çš„æ—¶é—´æµªè´¹ ï¼ˆå¦‚å°å®éªŒçš„å®éªŒï¼‰ å¿«é€Ÿæ¼”ç¤ºï¼ˆè¯¦è§æ¯å¹´çš„WWDCï¼‰ ä¸å¸¸ç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥ç‰¹æ®Šå¤„ç†ï¼ˆæˆ‘ä¸€èˆ¬ç”¨æ¥å¤„ç†ä¸ªåˆ«ç³»ç»Ÿé€‚é…ï¼‰ã€‚ ç»Ÿä¸€ç¼–ç è§„èŒƒ æœ€å ä»£ç å—ï¼ˆCode Snippetï¼‰çœŸçš„æ˜¯ä¸ªå¾ˆå¥½ç”¨çš„ä¸œä¸œï¼Œå¹³æ—¶é—²äº†ï¼Œå¯ä»¥æ•´ç†ä¸€ä»½é€‚åˆè‡ªå·±çš„ä»£ç å—ï¼Œç„¶åé€šè¿‡GitHub/giteeè¿›è¡Œå¤‡ä»½ã€‚å¦‚æœä¸æƒ³æ•´ç†ï¼Œä¹Ÿå¯ä»¥å»GitHub/giteeæœä¸€äº›æ‹¿æ¥ç”¨ï¼Œä½†æˆ‘çœŸçš„å»ºè®®è¿˜æ˜¯è‡ªå·±æ•´ç†ä¸€ä»½ã€‚\né™„ï¼šæœ€æ–°æ•´ç†çš„CodeSnippets\nä¸ºäº†æ–¹ä¾¿åç»­ä¿®æ”¹ï¼ˆæ–°å¢ã€åˆ é™¤ï¼‰åä¾ç„¶èƒ½åŠæ—¶åŒæ­¥ï¼Œæˆ‘è¿™é‡Œå¤‡ä»½åœ¨giteeä¸Šap_code_snippets_ocï¼ŒåŒæ—¶ï¼Œæˆ‘ä¹ŸåŠ å…¥äº†install.shï¼Œæ–¹ä¾¿ç»ˆç«¯å¿«é€Ÿæ›¿æ¢ï¼š\n1 2 /// è¿›å…¥æœ¬åœ°çš„ap_code_snippets_ocç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯ï¼š sh install.sh æ›¿æ¢å®Œï¼Œè®°å¾—è¦é‡å¯Xcodeã€‚\n","date":"2021-05-02T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2021/20210502.jpeg","permalink":"https://abnerpei.github.io/p/20210502/","title":"iOSä»£ç å—ï¼ˆCodeSnippetsï¼‰ä½ å€¼å¾—æ‹¥æœ‰ï¼šå¤§å¤§æå‡ç¼–ç æ•ˆç‡"},{"content":"PPMakeræ˜¯ä»€ä¹ˆâ“ å£°æ˜ï¼šPPMakerè·ŸMasonryåŠŸèƒ½ä¸Šæ˜¯å®Œå…¨ä¸åŒçš„åº“ï¼ŒPPMakeræ˜¯å¿«é€Ÿä¾¿æ·åˆ›å»ºUI/attributedTextç­‰çš„ï¼Œè€ŒMasonryæ˜¯å¸ƒå±€çš„ã€‚\nåšiOSå¼€å‘ï¼Œåˆ›å»ºUIæ§ä»¶ï¼Œå¿…é¡»çš„ä¸è¯´ï¼Œè¿˜å¤šï¼Œå°¤å…¶ä½ æ–°å…¥æ‰‹ä¸€ä¸ªé¡¹ç›®ã€‚\næˆ‘è‡ªå·±å†™ä»£ç ï¼Œå‘æ¥æƒ³çœäº‹ï¼šæ€ä¹ˆèƒ½ä¸ä¸€ä¸ªä¸€ä¸ªå±æ€§å†™ï¼Ÿ å¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åˆšå¼€å§‹åˆ›å»ºäº†å„ç§Toolæ¥å¤„ç†ï¼Œåæ¥ç”¨Categoryï¼Œå¯Categoryæœ‰ä¸ªçƒ¦äººçš„é—®é¢˜ï¼šæœ‰äº›å±æ€§æˆ‘ä¸éœ€è¦ä½†æ˜¯æ–¹æ³•å‚æ•°æœ‰ï¼Œè€Œæœ‰äº›å±æ€§æˆ‘éœ€è¦æ–¹æ³•å‚æ•°æ²¡æœ‰ã€‚\næ˜¨å¤©ï¼Œçœ‹åˆ°è‡§æˆå¨çš„å¦‚ä½•åˆ©ç”¨Objective-Cå†™ä¸€ä¸ªç²¾ç¾çš„DSLï¼ŒæŒºå¥½ï¼Œå°±æƒ³ç€ä¼˜åŒ–ä¸‹è‡ªå·±çš„ä»£ç ï¼Œäºæ˜¯å°±æœ‰äº† PPMaker.\nåœ¨æ­¤ï¼ŒçŒ®ä¸Šå¯¹è‡§è€å¸ˆçš„æ„Ÿè°¢ã€‚\nPPMakerçš„ä¸åŒï¼ˆä¼˜ç‚¹ï¼‰ â‘ ã€é“¾å¼è°ƒç”¨ï¼Œä»£ç ç®€æ´\nâ‘¡ã€ç‚¹è¯­æ³•åé¢æœ‰æç¤ºï¼ˆMasonryæ˜¯æ²¡æœ‰çš„ ï¼‰\nâ‘¢ã€ä¸éœ€è¦ç»ˆç»“è¯ï¼Œè‡§è€å¸ˆç»™çš„ç¤ºä¾‹æœ‰\nâ‘£ã€ä¸éœ€è¦åŠ©è¯ ï¼ˆå¦‚Masonryä¸­çš„withï¼‰ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç¼ºç‚¹å§\nâ‘¤ã€podå¯æ ¹æ®éœ€æ±‚éšæ„é€‰æ‹©\nâ‘¥ã€ä¸éœ€è¦çš„å±æ€§ï¼Œæ ¹æœ¬ä¸ç”¨ç®¡ ä¸»è¦å¯¹æ¯”Category\nPPMakerçš„ç”¨æ³• ç¬¬ä¸€æ­¥ã€å¯¼å…¥PPMaker\næ–¹æ³•ä¸€ã€ä½¿ç”¨CocoaPodså®‰è£… 1 pod \u0026#39;PPMaker\u0026#39;, \u0026#39;~\u0026gt; 0.0.22\u0026#39; æ–¹æ³•äºŒã€æ‰‹åŠ¨ä¸‹è½½æ‹–å…¥ ç¬¬äºŒæ­¥ã€ç”¨å¯¹åº”çš„ç±»ï¼ˆå¦‚:UILableï¼‰ç›´æ¥è°ƒç”¨pp_\nä½¿ç”¨ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªç®€å•çš„UILabelå¯¹è±¡\nmakerè°ƒç”¨ï¼Œç›´æ¥è°ƒUILabelå¯¹è±¡çš„å±æ€§ï¼Œå¦‚textã€textColorã€frameç­‰ï¼Œå½“ç„¶ä¹Ÿæœ‰è‡ªå®šä¹‰çš„ï¼Œå¦‚intoViewè¡¨ç¤ºè¦åŠ åˆ°å“ªä¸ªviewä¸Šã€fontSizeå®é™…ä¸Š[UIFont systemFontOfSize:fontSize]çš„ç®€åŒ–ç­‰ç­‰ã€‚\næ€»ä¹‹ï¼ŒPPMaker is very easy to useã€‚\nå›é¡¾ï¼šåˆ›å»ºUIæ§ä»¶çš„è·¯ç¨‹ èµ·åˆï¼šä¸€ä¸ªå±æ€§ä¸€ä¸ªå±æ€§èµ‹å€¼ 1 2 3 4 5 6 7 UILabel *lb = [[UILabel alloc]initWithFrame:CGRectMake(10, 10, 300, 50)]; [self.view addSubview:lb]; lb.backgroundColor = [UIColor whiteColor]; lb.text = @\u0026#34;æˆ‘æ˜¯ä¸€ä¸ªlb\u0026#34;; lb.textColor = [UIColor blueColor]; lb.textAlignment = NSTextAlignmentCenter; lb.font = [UIFont systemFontOfSize:18]; åæ¥ï¼šç”¨Categoryå¿«é€Ÿåˆ›å»º\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 @interface UILabel (EasyMake) +(UILabel *)lbMakeWithSuperV:(UIView *)superV frame:(CGRect)frame font:(UIFont *)font alignment:(NSTextAlignment)alignment text:(NSString *)text textColor:(UIColor *)textColor; @implementation UILabel (EasyMake) +(UILabel *)lbMakeWithSuperV:(UIView *)superV frame:(CGRect)frame font:(UIFont *)font alignment:(NSTextAlignment)alignment text:(NSString *)text textColor:(UIColor *)textColor { UILabel *lb = [[UILabel alloc]init]; if (superV) { [superV addSubview:lb]; } if (font) { lb.font = font; } if (text) { lb.text = text; } if (textColor) { lb.textColor = textColor; } lb.frame = frame; lb.textAlignment = alignment; return lb; } @end ç°åœ¨ï¼šé“¾å¼è°ƒç”¨çš„DSL\nç»“è¯­ PPMakeræ˜¯è‡ªå·±å†™çš„æœ€æ»¡æ„çš„ä¸€ä¸ªåº“ä¹‹ä¸€ï¼Œè§£å†³äº†è‡ªå·±ä¸€ç›´ä»¥æ¥åˆ›å»ºUIã€é…ç½®attributedText çš„è‹¦æ¼ï¼Œè¿™å…¶ä¸­ä¹Ÿå‚è€ƒäº†ä¸€äº›å¤§ç¥çš„çš„blogå’Œå¼€æºåº“ï¼Œåœ¨æ­¤ï¼Œè¡¨ç¤ºæ„Ÿè°¢ã€‚ä»Šå¤©ï¼Œåˆ†äº«è‡ªå·±çš„è¿™ä¸ªåº“ï¼Œå¸Œæœ›å¸®åŠ©åƒæˆ‘ä¸€æ ·çš„åŒå­¦ï¼Œå…¶æ¬¡ï¼Œå¸Œæœ›è§‰å¾—å¥½çš„ï¼Œç»™ä¸ªstarã€‚\nå½“ç„¶äº†ï¼Œè¿™ä¸ªåº“ï¼Œæˆ‘ä¼šæŒç»­æ›´æ–°çš„ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæ¬¢è¿æå‡ºæ¥ã€‚æˆ–è€…è°æœ‰æ›´å¥½çš„åšæ³•ï¼Œçƒ­çƒˆæ¬¢è¿å‘ŠçŸ¥ä¸€ä¸‹ï¼Œæ·±è¡¨è°¢æ„ï¼\n","date":"2018-05-09T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2018/20180509.jpeg","permalink":"https://abnerpei.github.io/p/ios%E9%93%BE%E5%BC%8F%E5%88%9B%E5%BB%BAui%E7%BB%88%E7%BB%93%E8%80%85-ppmaker/","title":"iOSé“¾å¼åˆ›å»ºUIç»ˆç»“è€… âœ PPMaker"},{"content":"ä¸€ã€å‰è¨€ æœ€è¿‘åœ¨è§£ç­”[æœ€æ–°ç‰ˆ]MJRefreshè§£æä¸è¯¦ç»†ä½¿ç”¨æŒ‡å¯¼å’ŒMJRefreshå®ç°åˆ·æ–°ï¼ˆä½¿ç”¨å®ƒçš„Blockæ–¹æ³•ï¼‰ä¸­ç®€å‹çš„æé—®ï¼Œæµ…è¯»äº†ä¸‹ MJRefresh çš„æºç  (å…³äºæºç è§£è¯»ï¼Œç½‘ä¸Šå·²æœ‰å¾ˆå¤šï¼Œæˆ‘åç»­ä¹Ÿä¼šå†™ä¸€ç¯‡æˆ‘è‡ªå·±çš„è§£è¯»ï¼Œä¸è¿‡ä»Šå¤©è¦è¯´çš„æ˜¯ï¼šå€Ÿé‰´åˆ«äººçš„æ€è·¯ï¼Œåšorå®Œå–„è‡ªå·±çš„äº‹ã€‚):\nåˆ©ç”¨KVOåœ¨- (void)willMoveToSuperview:(UIView *)newSuperviewæ–¹æ³•è°ƒç”¨æ—¶ç›‘å¬scrollViewçš„contentOffset/contentSizeå’ŒpanGestureRecognizerçš„stateå±æ€§ï¼Œç„¶ååšå¯¹åº”æ“ä½œã€‚\näºŒã€å¼€å‘å›°æƒ‘ é€šå¸¸ï¼Œä½œä¸ºiOSå¼€å‘äººå‘˜ï¼Œåˆ¤æ–­UIScrollView/UITableView/UICollectionViewçš„æ»šåŠ¨æƒ…å†µçš„äº‹ï¼Œæ—¶æœ‰å‘ç”Ÿã€‚å¦‚æœæ¯æ¬¡éƒ½å»å®ç°delegateæ–¹æ³•ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œæœ‰äº›éº»çƒ¦ã€‚é™¤äº†ä¸€éä¸€éçš„å†™ä»£ç†ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯å»ºä¸ªåŸºç±»ï¼Œä½†æ˜¯è¿™æ ·åŸºç±»è¿˜æ˜¯è¦å®ç°å¯¹åº”çš„delegateæ–¹æ³•ã€‚\nä¸‰ã€è§£å†³æ–¹æ³•ï¼šç»™UIScrollViewæ·»åŠ blockå±æ€§ç›‘å¬æ»šåŠ¨ å…ˆé¢„è§ˆä¸‹æ•ˆæœ(ä¸Šé¢çº¢è‰²çš„æ˜¯æ‰‹æœºå½•å±æ‰€è‡´)ï¼š å››ã€ç†æ¸…æ€è·¯ æ–°å»ºä¸€ä¸ªç±» PPMJRefreshComponent,ç±»ä¼¼MJRefreshä¸­çš„MJRefreshComponentï¼Œç”¨æ¥å½“åšè§‚å¯Ÿè€…; æ—¢ç„¶ PPMJRefreshComponent è¦è§‚å¯Ÿ UIScrollView çš„contentOffsetä»¥åŠpanGestureRecognizerçš„state,é‚£ä¹ˆ PPMJRefreshComponent å°±è¦å…³è”å½“å‰çš„ UIScrollViewï¼›å¹¶ä¸”ï¼ŒUIScrollView è¦æ‹¥æœ‰ä¸€ä¸ª PPMJRefreshComponent å¯¹è±¡ï¼ˆå¦‚ä¸‹å›¾ï¼šï¼‰ï¼› PPMJRefreshComponent è§‚å¯Ÿçš„ç»“æœæ€ä¹ˆä¼ é€’ç»™ UIScrollViewï¼Ÿæˆ‘é‡‡ç”¨çš„æ˜¯delegate(PPMJRefreshComponentDelegate),éœ€è¦ UIScrollView å¯¹è±¡éµå®ˆï¼›ï¼ˆæ­¤å¤„ä¸ä½¿ç”¨blockæ˜¯å› ä¸ºblockåµŒå¥—blockå®¹æ˜“å‡ºé—®é¢˜ï¼‰ UIScrollView å¯¹è±¡å®ç°ä»£ç†ï¼Œå¹¶è®¾ç½®scrollBlockçš„æ—¶å€™è§¦å‘ç›‘å¬ï¼š(ä»£ç å¦‚ä¸‹ï¼Œæ³¨é‡Šå·²å†™è¿›å») 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 @implementation UIScrollView (ScrollBlock) #pragma mark --- PPMJRefreshComponentDelegate -(void)scrollViewContentOffsetDidChange:(NSDictionary\u0026lt;NSKeyValueChangeKey,id\u0026gt; *)change{ [self contentOffsetBlockAction:change]; } -(void)scrollViewPanStateDidChange:(NSDictionary\u0026lt;NSKeyValueChangeKey,id\u0026gt; *)change{ [self panGestureRecognizerStateAction:change]; } -(void)contentOffsetBlockAction:(NSDictionary\u0026lt;NSKeyValueChangeKey,id\u0026gt; *)change { //è¿™ä¸ªå±æ€§å­—é¢ç†è§£æ„æ€ä¸ºï¼šæ­£åœ¨æ‹–åŠ¨ã€‚å®é™…ä¸Šæ˜¯ï¼šscrollViewæ˜¯å¦æ»šåŠ¨äº†ï¼Œåªè¦ä¸æ˜¯æœ€å¼€å§‹åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®çš„ä½ç½®ï¼Œå°±ä¸ºYESã€‚ if (!self.isDragging) { return; } //ã€æ³¨æ„ã€‘æ­¤å¤„è¦ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœè®¾ç½®contentInsetçš„è¯ï¼Œè¦ç»™pp_lastContentOffsetYèµ‹å€¼ä¸ºinsetTçš„åˆå§‹å€¼ if (!self.pp_lastContentOffsetY) { [self setupInitializeOffsetY]; } //è·å–å½“å‰çš„contentOffsetY CGFloat currentContentOffsetY = self.pp_FSB_offsetY; //å¦‚æœå‰åçš„contentOffsetYå€¼ç›¸åŒï¼Œå°±ä¸åšå¤„ç† CGFloat lastContentOffsetY = [self.pp_lastContentOffsetY floatValue]; if (currentContentOffsetY == lastContentOffsetY) { return; } //æ˜¯å¦æ˜¯å‘ä¸Šæ»‘ï¼Œåˆå§‹å€¼ä¸ºNO BOOL isToUp = NO; //å‘ä¸Šæ»‘åŠ¨ if (currentContentOffsetY \u0026gt; lastContentOffsetY) { //å¤„ç†æ»‘åŠ¨åˆ°åº•éƒ¨ï¼Œç»§ç»­ä¸Šæ»‘åç³»ç»Ÿè‡ªåŠ¨åå¼¹è€Œé‡å¤è°ƒç”¨çš„æƒ…å†µ if (currentContentOffsetY+self.pp_h \u0026gt; self.pp_FSB_contentH) { return; } isToUp = YES; }else{ //å‘ä¸‹æ»‘åŠ¨ //å¤„ç†å·²ç»æœ€ä¸Šé¢äº†ä»ç„¶ä¸‹æ‹‰è€Œåå¼¹æ—¶ï¼Œåå¤è°ƒç”¨ if (currentContentOffsetY \u0026lt;= self.pp_FSB_insetT) { return; } } //ç»™pp_lastContentOffsetYç»‘å®šå€¼ objc_setAssociatedObject(self, @selector(pp_lastContentOffsetY), [NSNumber numberWithFloat:currentContentOffsetY], OBJC_ASSOCIATION_RETAIN); //æ˜¯å¦è¶…è¿‡ä¸€ä¸ªå±å¹• BOOL isInOneScreen = (self.pp_FSB_insetT+self.pp_FSB_contentH \u0026lt;= self.pp_h); if (self.pp_scrollBlock) { self.pp_scrollBlock(currentContentOffsetY, isToUp,isInOneScreen); } } -(void)panGestureRecognizerStateAction:(NSDictionary\u0026lt;NSKeyValueChangeKey,id\u0026gt; *)change { if (self.panGestureRecognizer.state == UIGestureRecognizerStateEnded) { //å†…å®¹ä¸å¤Ÿä¸€ä¸ªå±å¹•æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›å¼¹ï¼Œè¿™æ—¶å€™è®°å¾—æŠŠpp_lastContentOffsetYé‡æ–°è®¾ç½®ä¸€ä¸‹ if (self.pp_FSB_insetT+self.pp_FSB_contentH \u0026lt;= self.pp_h) { [self setupInitializeOffsetY]; }else{ //è¶…è¿‡ä¸€ä¸ªå±å¹•,è¿™æ—¶å€™ä¸‹æ‹‰ï¼Œå½“æ¾å¼€çš„æ—¶å€™è¦æŠŠpp_lastContentOffsetYé‡æ–°è®¾ç½®ä¸€ä¸‹ if (self.pp_FSB_offsetY \u0026lt; self.pp_FSB_insetT) { [self setupInitializeOffsetY]; } } } } #pragma mark --- åˆå§‹åŒ–contentOffsetYçš„å€¼ -(void)setupInitializeOffsetY{ CGFloat currentContentOffsetY = -self.pp_FSB_insetT; objc_setAssociatedObject(self, @selector(pp_lastContentOffsetY), [NSNumber numberWithFloat:currentContentOffsetY], OBJC_ASSOCIATION_RETAIN); } -(void)setPp_scrollBlock:(PPUIScrollViewScrollBlock)pp_scrollBlock { //åœ¨è®¾ç½®scrollBlockçš„æ—¶å€™ï¼Œè§¦å‘ç›‘å¬ self.pp_component.delegate = self; objc_setAssociatedObject(self, @selector(pp_scrollBlock), pp_scrollBlock, OBJC_ASSOCIATION_RETAIN); } -(PPUIScrollViewScrollBlock)pp_scrollBlock { return objc_getAssociatedObject(self, _cmd); } @end é’ˆå¯¹ä¸Šé¢çš„ä»£ç è¡¥å……è¯´æ˜å¦‚ä¸‹ï¼š\næ³¨æ„ component çš„åˆè¯†ä¸å…³è”ï¼Œä¸€å®šè¦å¼„æ‡‚ä¸ºå•¥æˆ‘ä»£ç ä¸­è¦ç”¨runtimeå¼ºåˆ¶å…³è”; æ³¨æ„ pp_lastContentOffsetY çš„ä½¿ç”¨ï¼Œå®ƒæ˜¯ç»™ UIScrollView åŠ¨æ€ç»‘å®šçš„è®°å½•ä¸Šä¸€æ¬¡çš„contentOffsetYå€¼çš„ï¼Œåªæœ‰åœ¨æ»‘åŠ¨çš„æ—¶å€™æœ‰æ•ˆï¼Œæœ€ç»ˆå¦‚æœä½ æ”¾å¤–éƒ¨çš„è¯ï¼Œåç§»é‡è¿˜æ˜¯å’ŒcontentOffset.Yçš„å€¼ä¸€æ ·ã€‚ -(void)contentOffsetBlockAction:(NSDictionary\u0026lt;NSKeyValueChangeKey,id\u0026gt; *)changeè¿™ä¸ªæ–¹æ³•å¤„ç†æ»‘åŠ¨æƒ…å†µï¼Œä½†æ˜¯ å¼€å§‹ä¸‹æ‹‰ å’Œ ä¸Šæ‹‰åˆ°åº• çš„ä¸¤ç§ä¸´è¡—çŠ¶æ€æ—¶çš„ pp_lastContentOffsetY éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè€Œè¿™ä¸ªå¤„ç†å°±æ”¾åœ¨panGestureRecognizer.state == UIGestureRecognizerStateEndedçš„æ—¶å€™ã€‚ æœ€åï¼Œæ„Ÿè°¢ MJRefreshï¼\n2018-03-08 14:20:40 å¦‡å¥³èŠ‚å¿«ä¹ï¼ æ„Ÿè°¢å…¬å¸çš„ party,æ­¤åˆ» åƒç€é›¶é£Ÿå–ç€é¥®æ–™ï¼ŒåŒ†åŒ†ç»“æ–‡ã€‚\n","date":"2018-03-08T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2018/20180308.jpeg","permalink":"https://abnerpei.github.io/p/20180308/","title":"æµ…è¯»MJRefreshåè‡ªå®šä¹‰äº†ä¸ªUIScrollViewç›‘å¬æ»šåŠ¨çš„blockå±æ€§"},{"content":" æŸå¤©ï¼Œé—²æ¥æ— èŠç‚¹å‡»å¾®ä¿¡é€šè®¯å½•å³è¾¹çš„ç´¢å¼•ï¼ˆå…·ä½“æ“ä½œå¦‚ä¸‹ï¼šæ‰“å¼€å¾®ä¿¡\u0026mdash;é€šè®¯å½•ï¼Œç„¶åå³æ‰‹ç‚¹å‡»æŸä¸ªç´¢å¼•ï¼Œæ‰‹æŒ‡åˆ«æ¾å¼€ï¼Œç„¶åå·¦æ‰‹ç‚¹å‡»æŸä¸ªè”ç³»äººcellï¼Œè·³è½¬åå†è¿”å›ï¼Œä½ åˆšæ‰é•¿æŒ‰çš„æ”¾å¤§ç´¢å¼•è¿˜åœ¨ï¼Œå¹¶ä¸”å†æ»‘åŠ¨ï¼Œç´¢å¼•å¯¹åº”å­—æ¯ä¹Ÿä¸å˜åŒ–ï¼Œç´¢å¼•è§†å›¾å¡ä½ã€‚ï¼‰ï¼Œå‘ç°äº†è¿™ä¸ªbugï¼ˆæˆ‘éƒ½æ»‘åŠ¨åˆ°Läº†ï¼Œæ”¾å¤§çš„ç´¢å¼•è¿˜æ˜¯Mï¼‰ï¼Œå¦‚ä¸‹ï¼š\nç”±äºè‡ªå·±çš„é¡¹ç›®ä¹Ÿæœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼ŒåŒæ ·æ“ä½œï¼Œä¹Ÿæœ‰åŒæ ·çš„bugï¼Œäºæ˜¯å°±èµ¶ç´§ä¿®å¤ä¸€ä¸‹ã€‚\né—®é¢˜æœ‰äº†ï¼Œè§£å†³é—®é¢˜çš„å…³é”®å°±æ˜¯æ‰¾åˆ°åŸå› å¹¶ç»™å‡ºåˆç†çš„è§£å†³æ–¹æ¡ˆã€‚\nWhy?\nWhy?\nWhy?\nåŸå› ï¼šæ”¾å¤§çš„ç´¢å¼•è§†å›¾åœ¨æ˜¾ç¤ºçš„æƒ…å†µä¸‹ç‚¹å‡»tableViewCellæ²¡æœ‰éšè—æ‰.\nè§£å†³æ–¹æ¡ˆï¼šåœ¨didSelectRowAtIndexPathæ–¹æ³•é‡Œéšè—(orç§»é™¤)æ”¾å¤§äº†çš„ç´¢å¼•è§†å›¾ã€‚\næ–¹æ¡ˆä¸€ï¼šç”¨é€šçŸ¥ï¼ŒdidSelectRowAtIndexPathè°ƒç”¨çš„æ—¶å€™ç»™**PPSectionTitleIndexView**å‘ä¸ªé€šçŸ¥ã€‚ æ–¹æ¡ˆäºŒ ï¼šç”¨runtimeï¼ŒdidSelectRowAtIndexPathè°ƒç”¨çš„æ—¶å€™ç»™UItableViewæ·»åŠ ä¸€ä¸ªblock,**PPSectionTitleIndexView**é‡Œé¢çš„tableViewå®ç°blockã€‚ ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”ï¼š\næ–¹æ¡ˆä¸€: éœ€è¦æ¯æ¬¡è°ƒç”¨didSelectRowAtIndexPathæ—¶éƒ½è¦å‘é€ä¸€ä¸ªé€šçŸ¥ï¼›\næ–¹æ¡ˆäºŒ: ä»€ä¹ˆä¹Ÿä¸ç”¨åšã€‚æ‰€ä»¥ï¼Œå½“ç„¶æ–¹æ¡ˆäºŒæ›´å¥½ã€‚\næ‰¯äº†é‚£ä¹ˆå¤šï¼Œç°åœ¨è¿›å…¥å®æˆ˜ã€‚\nç¬¬ä¸€æ­¥ ï¼šåˆ›å»ºPPSectionTitleIndexViewç»§æ‰¿è‡ªUIViewï¼Œå¹¶å£°æ˜ä»£ç†PPSectionTitleIndexViewDelegateï¼Œä»£ç å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 #import \u0026lt;UIKit/UIKit.h\u0026gt; NS_ASSUME_NONNULL_BEGIN @protocol PPSectionTitleIndexViewDelegate \u0026lt;NSObject\u0026gt; @required /** ä¸PPSectionTitleIndexViewç›¸å…³è”çš„viewï¼ˆUITableViewï¼‰ */ -(UITableView *)sectionTitleIndexViewAssociatedView; /** sectionçš„titles */ -(NSArray\u0026lt;NSString *\u0026gt; *)sectionTitleIndexViewSectionTitles; @end @interface PPSectionTitleIndexView : UIView /** ç´¢å¼•æ˜¯å¦æ­£åœ¨æ˜¾ç¤º */ @property(nonatomic,assign,readonly) BOOL isShowingIndex; //è¿™ä¸‰ç§ä¸èƒ½ç”¨äºåˆå§‹åŒ– -(instancetype)initWithFrame:(CGRect)frame NS_UNAVAILABLE; -(instancetype)init NS_UNAVAILABLE; +(instancetype)new NS_UNAVAILABLE; -(instancetype)initWithFrame:(CGRect)frame delegate:(_Nullable id\u0026lt;PPSectionTitleIndexViewDelegate\u0026gt;)delegate NS_DESIGNATED_INITIALIZER; +(instancetype)pp_sectionTitleIndexViewWithFrame:(CGRect)frame delegate:(_Nullable id\u0026lt;PPSectionTitleIndexViewDelegate\u0026gt;)delegate; @end NS_ASSUME_NONNULL_END ç¬¬äºŒæ­¥ï¼šè®¾ç½®PPSectionTitleIndexView æ€è·¯ï¼šæ¯ä¸ªç´¢å¼•ç”¨UIButton,å½“å‰ç‚¹å‡»çš„æ”¾å¤§ç´¢å¼•ç”¨UILabelæ˜¾ç¤ºã€‚\næ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š\n1.åˆ›å»ºUIçš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 -(instancetype)initWithFrame:(CGRect)frame delegate:(id\u0026lt;PPSectionTitleIndexViewDelegate\u0026gt;)delegate { self = [super initWithFrame:frame]; if (self) { self.delegate = delegate; [self creatUI]; } return self; } -(void)creatUI { //1. å…ˆæ£€éªŒå¿…é¡»å®ç°çš„åè®®æœ‰æ²¡æœ‰å®ç° [self verifyRequiredProtocol]; //2. åˆ›å»ºç´¢å¼•UI [self creatIndexUI]; //3. æ·»åŠ å¹³ç§»æ‰‹åŠ¿ [self addPanGesture]; } //æ­¤å¤„åªè´´å‡ºæ¥indexçš„buttonåˆ›å»ºä»£ç  for (int i = 0; i\u0026lt;self.indexTitles.count; i++) { UIButton *item = [UIButton buttonWithType:UIButtonTypeCustom]; [self addSubview:item]; item.tag = 100+i; item.frame = CGRectMake(0, topOrBottomMargin+(oneIndexWidth+itemMargin)*i, indexVWidth, oneIndexWidth); item.titleEdgeInsets = UIEdgeInsetsMake(0, self.frame.size.width-oneIndexWidth-5, 0, 5); [item setTitle:self.indexTitles[i] forState:UIControlStateNormal]; [item setTitle:self.indexTitles[i] forState:UIControlStateHighlighted]; [item setTitleColor:[UIColor blueColor] forState:UIControlStateNormal]; [item setTitleColor:[UIColor blueColor] forState:UIControlStateHighlighted]; item.backgroundColor = [UIColor clearColor]; item.titleLabel.font = [UIFont systemFontOfSize:12]; [item addTarget:self action:@selector(btnClickedDown:) forControlEvents:UIControlEventTouchDown]; //åªè¦ç‚¹å‡» [item addTarget:self action:@selector(btnTouchUpInside:) forControlEvents:UIControlEventTouchUpInside]; //ç‚¹å‡»æ¾æ‰‹ } 2.å“åº”äº‹ä»¶çš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 -(void)btnClickedDown:(UIButton *)sender { //1. è·å–å½“å‰sectionTitleçš„frame CGRect currentSectionTitleRect = [self.tableView rectForSection:sender.tag-100]; //2. æŠŠtableViewå½“å‰sectionæ»šåŠ¨åˆ°top (ä¸è¦åŠ¨ç”»æ•ˆæœæ›´å¥½) [self.tableView setContentOffset:CGPointMake(currentSectionTitleRect.origin.x, currentSectionTitleRect.origin.y) animated:NO]; //3. æŠŠå½“å‰çš„indexæ”¾å¤§æ˜¾ç¤ºåˆ°å±å¹•ä¸­é—´ NSString *currentIndexStr = sender.titleLabel.text; self.currentIndexShowLB.text = currentIndexStr; //4. å¤„ç†indexStr if (currentIndexStr.length == 1) { self.currentIndexShowLB.font = [UIFont systemFontOfSize:35]; }else{ self.currentIndexShowLB.font = [UIFont systemFontOfSize:18]; } //5. å±å¹•ä¸­é—´æ˜¾ç¤ºå½“å‰index self.currentIndexShowLB.hidden = NO; } -(void)btnTouchUpInside:(UIButton *)sender { //è¯¥æ–¹æ³•æ˜¯åœ¨btnClickedDownåæ‰§è¡Œ self.currentIndexShowLB.hidden = YES; } #pragma mark --- æ·»åŠ å¹³ç§»æ‰‹åŠ¿ -(void)addPanGesture { UIPanGestureRecognizer *panGR = [[UIPanGestureRecognizer alloc]initWithTarget:self action:@selector(panAction:)]; [self addGestureRecognizer:panGR]; } -(void)panAction:(UIPanGestureRecognizer *)panGR { //1. è·å–æ‰‹æŒ‡å½“å‰ä½ç½®çš„point CGPoint fingerTapPoint = [panGR locationInView:self]; //2. éå†selfä¸Šçš„æ‰€æœ‰è‡ªè§†å›¾ï¼ˆUIButton *ï¼‰,å¦‚æœå®ƒçš„tagå’Œä¸Šæ¬¡ä¸ä¸€æ ·ï¼Œæ‰§è¡ŒtouchDownæ–¹æ³• for (UIView *aV in self.subviews) { if ([aV isKindOfClass:[UIButton class]] \u0026amp;\u0026amp; aV.tag != _selectedBtnTag \u0026amp;\u0026amp; CGRectContainsPoint(aV.frame, fingerTapPoint)) { _selectedBtnTag = aV.tag; [self btnClickedDown:(UIButton *)aV]; } } //3. æ‰‹åŠ¿ç»“æŸæ—¶ï¼Œéšè—å±å¹•ä¸­é—´çš„showIndexLB if (panGR.state == UIGestureRecognizerStateEnded) { self.currentIndexShowLB.hidden = YES; } } è‡³æ­¤ï¼Œæƒ³è¦çš„åŠŸèƒ½ç®—æ˜¯å®ç°äº†ï¼Œä½†æ˜¯æ–‡ç« ä¸€å¼€å§‹æåˆ°çš„bugä¹Ÿå‡ºç°äº†ï¼ŒğŸ˜œã€‚\nç¬¬ä¸‰æ­¥ï¼šè§£å†³Bug å…³é”®ï¼štableViewçš„Category\nruntimeæ–¹æ¡ˆçš„å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š\næ‹¦æˆªUITableViewçš„ç³»ç»ŸsetDelegateï¼Œç”¨pp_setDelegateæ›¿æ¢ï¼› åˆ¤æ–­delegateæ˜¯å¦å“åº”ç³»ç»Ÿçš„tableView:didSelectRowAtIndexPath: ï¼Œå¦‚æœå“åº”æ‰èƒ½ç»§ç»­3ï¼› æ ¹æ®ç³»ç»Ÿçš„ä»£ç†tableView:didSelectRowAtIndexPath: æ–¹æ³•å’Œå¯¹åº”çš„æŒ‡é’ˆç»™ä»£ç†ç±»[delegate class]åˆ©ç”¨runtimeçš„class_addMethodæ·»åŠ ä¸€ä¸ªdidSelectedæ–¹æ³•@selector(pp_fakeTableView:didSelectRowAtIndexPath:)ï¼Œå¹¶æ›¿æ¢ä¸ºpp_tableView:didSelectRowAtIndexPath:. åˆ©ç”¨NSInvocationåœ¨æ›¿æ¢çš„didSelectedæ–¹æ³•pp_tableView:didSelectRowAtIndexPath:ä¸­è°ƒç”¨pp_fakeTableView:didSelectRowAtIndexPath:,å› ä¸ºpp_fakeTableView:didSelectRowAtIndexPath:å’Œç³»ç»Ÿçš„tableView:didSelectRowAtIndexPath:æŒ‡é’ˆæŒ‡å‘ç›¸åŒï¼Œæ‰€ä»¥å°±ç›¸å½“äºè°ƒç”¨ç³»ç»Ÿçš„tableView:didSelectRowAtIndexPath:ï¼Œè¿™æ ·å°±å®ç°äº†æˆ‘ä»¬çš„éœ€æ±‚ã€‚ æˆ‘æ€•æˆ‘è¯´æ˜çš„ä¸æ¸…æ¥šï¼Œç‰¹æ„ç”»äº†ä¸ªå›¾ï¼š\nä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 ///** // * é€šè¿‡ç»™å®šçš„æ–¹æ³•åå’Œå®ç°ï¼ŒåŠ¨æ€ç»™ç±»æ·»åŠ ä¸€ä¸ªæ–¹æ³• // * // * @param cls è¦æ·»åŠ æ–¹æ³•çš„ç±». // * @param name æŒ‡å®šäº†æ–¹æ³•åçš„è¦æ·»åŠ åˆ°ç±»çš„æ–¹æ³•. // * @param imp æ·»åŠ æ–¹æ³•çš„å‡½æ•°å®ç°ï¼ˆå‡½æ•°åœ°å€). // * @param types å‡½æ•°çš„ç±»å‹ï¼Œ(è¿”å›å€¼+å‚æ•°ç±»å‹). // * // * @return å¦‚æœæ·»åŠ æˆåŠŸå°±è¿”å›YESï¼Œå¤±è´¥è¿”å›NOï¼ˆå¦‚æœè¯¥ç±»ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªç›¸åŒçš„æ–¹æ³•åçš„æ–¹æ³•å®ç°ï¼‰. // * // * @note æ³¨: class_addMethodå°†é‡å†™çˆ¶ç±»çš„å®ç°ï¼Œä½†æ˜¯ä¸ä¼šæ›¿æ¢è¯¥ç±»ä¸­å·²ç»æœ‰çš„å®ç°ï¼Œ // å¦‚æœæƒ³æ”¹å˜è¯¥ç±»ä¸­å·²æœ‰çš„å®ç°ï¼Œè¯·ä½¿ç”¨method_setImplementation // */ //OBJC_EXPORT BOOL class_addMethod(Class cls, SEL name, IMP imp,const char * types) -(void)pp_setDelegate:(id\u0026lt;UITableViewDelegate\u0026gt;)delegate { if(delegate){ //ç³»ç»ŸåŸç”Ÿçš„didSelectedæ–¹æ³• SEL systemDidSelectedSelector = @selector(tableView:didSelectRowAtIndexPath:); //æˆ‘è‡ªå·±é‡å†™çš„didSelectedæ–¹æ³•ï¼ˆç”¨äºæ›¿æ¢ç³»ç»Ÿçš„ï¼‰ SEL ppDidSelectedSelector = @selector(pp_tableView:didSelectRowAtIndexPath:); //VIPï¼šå‡çš„didSelectedæ–¹æ³•ï¼ˆå’Œç³»ç»ŸåŸç”Ÿçš„didSelectedæ–¹æ³•æŒ‡é’ˆåœ°å€ç›¸åŒï¼Œä½†ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œå´å“åº”åŒæ ·äº‹ä»¶ï¼‰ SEL fakeDidSelectedSelector = @selector(pp_fakeTableView:didSelectRowAtIndexPath:); if ([delegate respondsToSelector:systemDidSelectedSelector]) { //ç³»ç»Ÿçš„ä»£ç†didSelectedæ–¹æ³•å’Œå¯¹åº”çš„æŒ‡é’ˆ Method systemDidSelectedMethod = class_getInstanceMethod([delegate class], @selector(tableView:didSelectRowAtIndexPath:)); IMP systemDidSelectedMethodIMP = method_getImplementation(systemDidSelectedMethod); //VIPï¼šæ­¤å¤„ç»™ç³»ç»ŸåŸç”Ÿçš„didSelectedæ–¹æ³•ä¸Šæ·»åŠ æ–°çš„æ–¹æ³•ï¼ˆåªè¦æ–¹æ³•åä¸ä¸€æ ·ï¼Œå°±å¯ä»¥æˆåŠŸï¼Œè¯¦è§ç³»ç»Ÿapiä¸­çš„@returnè¯´æ˜ï¼‰ //æ³¨æ„æ­¤æ–¹æ³•æ”¾ç½®ä½ç½®ï¼Œä¸èƒ½æ”¾åœ¨ä¸‹é¢çš„class_replaceMethodåé¢ï¼ˆå› ä¸ºå·²ç»è¢«æ›¿æ¢äº†ï¼ŒæŒ‡é’ˆä¼šæŒ‡å‘tableView *çš„pp_tableView:didSelectRowAtIndexPath:ï¼‰ class_addMethod([delegate class], fakeDidSelectedSelector, systemDidSelectedMethodIMP, method_getTypeEncoding(systemDidSelectedMethod)); //è‡ªå·±é‡å†™çš„didSelectedï¼Œç”¨æ¥å¤„ç†æ‹¦æˆªåæƒ³åšçš„äº‹æƒ…ï¼ˆæ¯”å¦‚ï¼šå‘é€šçŸ¥ï¼Œblockå›è°ƒç­‰ï¼‰ Method ppDidSelectedMethod = class_getInstanceMethod([self class], ppDidSelectedSelector); IMP ppDidSelectedMethodIMP = method_getImplementation(ppDidSelectedMethod); //ç”¨è‡ªå·±é‡å†™çš„æ›¿æ¢ç³»ç»ŸåŸç”Ÿçš„ class_replaceMethod([delegate class], systemDidSelectedSelector, ppDidSelectedMethodIMP, method_getTypeEncoding(systemDidSelectedMethod)); } } //æ‹¦æˆªåŸç”Ÿçš„delegateï¼Œåˆ«å¿˜äº†è°ƒç”¨ï¼ˆæ­¤å¤„è°ƒç”¨pp_setDelegate:å®é™…ä¸Šå°±æ˜¯è°ƒç”¨setDelegate:ï¼Œè¯´å¥ä¸è¯¥è¯´çš„è¯ï¼Œæ­¤å¤„çœ‹ä¸æ‡‚ï¼Œruntimeä½ æ ¹æœ¬ä¸ä¼šï¼‰ [self pp_setDelegate:delegate]; } -(void)pp_tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath { //æ–¹æ¡ˆ(é€šçŸ¥)éƒ½ç”¨çš„åˆ°çš„é€šçŸ¥ï¼Œå¾ˆæ˜¾ç„¶å¤ªè´¹äº‹ï¼Œä¸æ–¹ä¾¿ /* NSNotification *not = [[NSNotification alloc]initWithName:PPTableViewDidSelectedNotificationKey object:nil userInfo:nil]; [[NSNotificationCenter defaultCenter]postNotification:not]; */ //æ–¹æ¡ˆï¼ˆruntimeï¼‰ï¼šç»™tableViewæ·»åŠ ç‚¹å‡»blockï¼Œã€‚ã€‚ã€‚ã€‚å—¯ï¼Œæœ‰æ²¡æœ‰æƒ³åˆ°æ›´å¤šï¼Ÿï¼Ÿç®€åŒ–æ‰€æœ‰çš„delegateä¸dataSourceæ–¹æ³•ï¼Œæ­¤å¤„ä¸è¯´å¤ªå¤š if (tableView.pp_didSelectedBlock) { tableView.pp_didSelectedBlock(tableView, indexPath); } //VIP: æ­¤æ—¶ï¼Œç³»ç»ŸåŸç”Ÿçš„didSelectedæ–¹æ³•å·²ç»è¢«æ‹¦æˆªï¼Œå¹¶ä¸”åšäº†ä½ æƒ³åšçš„äº‹æƒ…ï¼Œå¯æ˜¯æ€ä¹ˆè®©ç³»ç»ŸåŸç”Ÿçš„didSelectedè¿˜èƒ½å“åº”ç‚¹å‡»ï¼Ÿ /* æ–¹æ¡ˆä¸€ï¼š ä¸ç”¨class_addMethodæ–¹æ³•ï¼Œè€Œæ˜¯åœ¨[delegate respondsToSelector:systemDidSelectedSelector]æ¡ä»¶è¯­å¥é‡Œ æ·»åŠ ä»£ç†ç»‘å®šï¼š objc_setAssociatedObject(PPTableViewDidSelectedNotificationKey, @selector(pp_tableView:didSelectRowAtIndexPath:), delegate, OBJC_ASSOCIATION_RETAIN); ç„¶ååœ¨æ­¤å¤„ï¼Œæ‰§è¡Œï¼š id ppDelegate = objc_getAssociatedObject(PPTableViewDidSelectedNotificationKey, _cmd); [ppDelegate pp_tableView:tableView didSelectRowAtIndexPath:indexPath]; å“¦ğŸ˜¯ï¼Œå‚»äº†ï¼Œè¿™ç›¸å½“äºç›´æ¥è°ƒç”¨ç³»ç»Ÿçš„didSelectedæ–¹æ³•ï¼Œ/(ã„’oã„’)/~~ï¼Œé”™ï¼é”™ï¼é”™ï¼ */ //æ–¹æ¡ˆäºŒï¼šåˆ©ç”¨NSInvocationåº•å±‚å‘æ¶ˆæ¯ï¼Œå¦‚ä¸‹ï¼š SEL fakeDidSelectedSelector = @selector(pp_fakeTableView:didSelectRowAtIndexPath:); NSMethodSignature *methodSignature = [[tableView.delegate class]instanceMethodSignatureForSelector:fakeDidSelectedSelector]; if (methodSignature == nil) { //å¯ä»¥æŠ›å‡ºå¼‚å¸¸ä¹Ÿå¯ä»¥ä¸æ“ä½œã€‚ } NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:methodSignature]; invocation.target = tableView.delegate; invocation.selector = fakeDidSelectedSelector; [invocation retainArguments]; [invocation invoke]; } 2017å¹´æœ€åä¸€å¤©äº†ï¼Œä¸€é¦–æ­Œå…±å‹‰ï¼š ","date":"2017-12-31T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2017/20171231.jpeg","permalink":"https://abnerpei.github.io/p/20171231/","title":"runtimeå®æˆ˜ç³»åˆ—ï¼ˆä¸€ï¼‰--- å¾®ä¿¡é€šè®¯å½•bugçš„å®Œç¾è§£å†³"},{"content":" æˆ‘ ï¼šâ€œ2017å¹´è¿˜æœ‰å¤šä¹…ï¼Ÿâ€\næˆ‘ ï¼šâ€œ â€˜å†¬å¤©æ¥äº†ï¼Œæ˜¥å¤©è¿˜ä¼šè¿œå—ï¼Ÿâ€™ï¼Œé©¬ä¸Šå°±è¦æ­¥å…¥2018å¹´ï¼Œæ‚¨è¯´2017å¹´è¿˜æœ‰å¤šä¹…ã€‚æ‚¨å°±çœ‹ç€å§ï¼Œä¸‹ä¸ªæœˆåˆ°å¤„éƒ½æ˜¯2017å¹´å¹´ç»ˆæ€»ç»“ï¼â€\nI\u0026rsquo;sorry,è¿›å…¥æ­£é¢˜ï¼š\næˆ‘ä¸ªäººå†™æœ¬æ–‡çš„ç›®çš„åªæœ‰ä¸€ä¸ªï¼šè®©ä½ è½»æ¾åˆ¶ä½œè‡ªå·±çš„podåº“ ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘ç¬¨ï¼Ÿç½‘ä¸Šçš„æ•™ç¨‹ï¼Œæˆ‘çœ‹çš„æœ‰ç‚¹ğŸ˜“ï¼ˆæ™•ï¼‰ï¼Œä¸è¿‡æœ€ç»ˆè¿˜æ˜¯æ‘¸ç´¢å‡ºæ¥äº†ï¼Œå¹¶ä¸”æ˜ç™½äº†123ï¼Œsoï¼Œè¯·å…è®¸æˆ‘ä»¥æˆ‘â€œç¬¨â€çš„æ–¹å¼æ¥è®©ä½ è½»æ¾ã€‚\nç¬¬â‘ æ­¥ï¼šåœ¨GitHubä¸Šæ–°å»ºä¸€ä¸ªä»“åº“ è¯´æ˜ï¼šç”±äºè‡ªå·±åˆ›å»ºPPKitæ—¶æ²¡æœ‰æˆªå›¾ï¼Œè¿™é‡Œä¸ºäº†è¯´æ˜ï¼Œæ–°å»ºäº†PPKit1æ¥æˆªå›¾è¯´æ˜ï¼Œè°…è§£ï¼\nç¬¬â‘¡æ­¥ï¼šcloneé¡¹ç›®åˆ°æœ¬åœ°ï¼Œå¹¶åˆ›å»º.podspecæ–‡ä»¶ å…·ä½“cloneä¸åˆ›å»º.podspecæ–‡ä»¶çš„å‘½ä»¤å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 //2.1ï¼ˆå…·ä½“è·¯å¾„ï¼Œçœ‹ä½ è‡ªå·±æ”¾ç½®ï¼‰ cd /Users/peijianbo/Documents/MTTest //2.2 git clone https://github.com/chinesemanbobo/PPKit1.git //2.3 (åˆ‡æ¢åˆ°å¼€æºåº“åç›¸åŒçš„ç›®å½•) cd /Users/peijianbo/Documents/MTTest/PPKit1 //2.4 ï¼ˆå¾ˆé‡è¦çš„ç¬¬ä¸€æ­¥ï¼Œcreateåé¢å¿…é¡»æ˜¯å¼€æºåº“åï¼Œæ­¤å¤„æ˜¯PPKit1ï¼‰ pod spec create PPKit1 è‡³æ­¤ï¼Œä¼šå‡ºç°Specification created at PPKit1.podspecã€‚Good!\nç¬¬â‘¢æ­¥ï¼šé…ç½®.podspecï¼Œå°¤å…¶æ˜¯é‡Œé¢çš„.source_filesæ–‡ä»¶è¦æ³¨æ„ æ³¨æ„ï¼šæ­¤å¤„å¼€å§‹ï¼Œæˆ‘ä»¬å†å›åˆ°PPKitã€‚ï¼ˆå¦‚æœä½ è‡ªå·±çš„åº“ï¼Œè¯·æ›¿æ¢PPKitä¸ºä½ çš„åº“åæ¥é˜…è¯»ï¼‰ã€‚\n3.1 æ‰“å¼€PPKit.podspecæ–‡ä»¶ï¼ˆæˆ‘ç”¨çš„æ˜¯Sublime Textï¼Œæç¤ºã€å…³é”®å­—é«˜äº®å¤„ç†çš„æ¯”è¾ƒå¥½ï¼‰ï¼Œæˆ‘è§‰å¾—å¾ˆæœ‰å¿…è¦è¯»è¯»å¼€å¤´çš„3è¡Œæ³¨é‡Šï¼ŒçœŸçš„æ˜¯å¾ˆæœ‰å¿…è¦ã€‚ï¼ˆæˆ‘è‡ªå·±å°±æ˜¯å› ä¸ºåæ¥æ‰è¯»è¿™3è¡Œæ³¨é‡Šï¼Œä¸­é—´æµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼‰ã€‚ä¸‹é¢ï¼Œæˆ‘ç®€å•ç¿»è¯‘ä¸‹ï¼š\n1 2 3 4 5 6 # Be sure to run `pod spec lint PPKit.podspec\u0026#39; to ensure this is a # valid spec and to remove all comments including this before submitting the spec. # # To learn more about Podspec attributes see http://docs.cocoapods.org/specification.html # To see working Podspecs in the CocoaPods repo see https://github.com/CocoaPods/Specs/ # åœ¨ä½ æäº¤.podspecæ–‡ä»¶åˆ°CocoaPodså‰ï¼ŒåŠ¡å¿…è¦åœ¨å‘½ä»¤è¡Œè¿è¡Œpod spec lint PPKit.podspecæ¥ç¡®ä¿.podspecæœ‰æ•ˆï¼Œå¹¶ä¸”åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Šï¼ŒåŒ…æ‹¬è¿™å¥ï¼ˆBe sure \u0026hellip; submitting the spec.ï¼‰ã€‚ ä½ å¯ä»¥åœ¨cocoapods.orgçœ‹åˆ°æ›´å¤šå…³äºpodspec(podè§„åˆ™)çš„å±æ€§çš„ä¿¡æ¯ã€‚ ä½ å¯ä»¥åœ¨GitHubä¸ŠæŸ¥çœ‹å½“å‰éƒ½æœ‰é‚£äº›æœ‰æ•ˆçš„ã€å¯ä»¥ç”¨çš„Pods. ä¸Šé¢ç¬¬3æ¡ï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å¼€çœ‹ä¸€çœ‹ï¼Œä¿è¯ä½ æœ‰æ”¶è·ï¼Œå¦‚ä¸‹ï¼š\nç‚¹å¼€åï¼Œåœ¨This repositoryé‡Œè¾“å…¥**AFNetworking**,ç„¶åæ‘Enteré”®æœç´¢ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹å›¾ï¼Œå…ˆåˆ«æƒŠå¥‡(è‡³äºæˆ‘å†ä¸‹é¢æˆªå›¾ä¸Šè¯´çš„ï¼Œæœ¬åœ°ä¹Ÿæœ‰ï¼Œå°±ä¸ä¸Šå›¾äº†)ï¼š çœ‹åˆ°è¿™ï¼Œå¦‚æœä½ çš„é¡¹ç›®ç”¨åˆ°äº†CocoaPods,æœ‰æ²¡æœ‰ä¸€ç§ â€œå™¢\u0026hellip;ï¼ŒåŸæ¥æ˜¯è¿™æ ·çš„â€çš„æŸ³æš—èŠ±æ˜åˆä¸€æ‘çš„æ„Ÿè§‰ï¼Œå¦‚æœä½ æœ‰ï¼Œä½ NBï¼›å¦‚æœæ²¡æœ‰ï¼Œæ²¡æœ‰å°±ç®—äº†ï¼Œä½ æ›´è¦è®¤çœŸçœ‹ä¸‹å»ï¼åæ­£æˆ‘æœ‰ã€‚å˜¿å˜¿ï¼\næ”¾å¤§æ‹›çš„æ—¶å€™æ¥äº†ï¼šCocoaPodsè¯´ç™½äº†ï¼Œå°±æ˜¯å¸®æˆ‘ä»¬ç®¡ç†ç¬¬ä¸‰æ–¹orè‡ªå·±çš„åº“ï¼›è€Œå®ƒä¸è¿‡ä¹Ÿæ˜¯ä¸€ä¸ª.xcodeprojå·¥ç¨‹ã€‚åªä¸è¿‡ï¼Œå®ƒæ˜¯ä¸“é—¨ç®¡ç†ç¬¬ä¸‰æ–¹orè‡ªå·±çš„åº“çš„å·¥ç¨‹ï¼Œè€Œå®ƒçš„å·¥ä½œåŸç†å°±æ˜¯ï¼šä½ æŠŠ.podspecæ–‡ä»¶åˆ¶ä½œå¥½ï¼Œç„¶åtrunk push (åé¢åè®²åˆ°)ç»™å®ƒï¼Œå®ƒå†æŠŠ.podspecæ–‡ä»¶ä¿å­˜ä¸º.podspec.jsonæ–‡ä»¶æ”¾åˆ°GitHubï¼Œä½ éœ€è¦çš„è¯ï¼Œå®ƒé€šè¿‡è¿™ä¸ª.podspec.jsonæŠŠGitHubä¸Šå¯¹åº”çš„å¼€æºåº“çš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾åˆ°ä½ çš„å·¥ç¨‹é‡Œã€‚è‡³æ­¤ï¼ŒOKã€‚\nè¯´äº†è¿™ä¹ˆå¤šï¼Œå†æ¥å¼ å›¾ï¼Œè¯å®ä¸‹ï¼Œæˆ‘ä»¬ç»§ç»­è®²Podåº“çš„åˆ¶ä½œï¼Œå›¾å¦‚ä¸‹ï¼ˆä¸ä¿¡ä¹Ÿä¸è¡Œï¼‰ï¼š\né‚£å°±æ‰“å¼€PPKit.podspec,åˆ é™¤é‡Œé¢æ‰€æœ‰çš„æ³¨é‡Šã€‚ç„¶åä¿®æ”¹ï¼Œä¸‹é¢ç»™å‡ºPPKit.podspecä»¥ä¾¿å‚è€ƒï¼Œæ³¨é‡Šæˆ‘ä»¥åŠåŠ è¿›å»ï¼ˆå¦‚æœä½ å‘å¸ƒçš„è¯ï¼Œæœ€å¥½æ³¨é‡Šå»æ‰ï¼Œæ­¤å¤„åªæ˜¯ä¸ºäº†è¯´æ˜ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 Pod::Spec.new do |s| #å¼€æºåº“çš„åå­— s.name = \u0026#34;PPKit\u0026#34; #å¼€æºåº“å½“æœŸç‰ˆæœ¬ s.version = \u0026#34;0.0.6\u0026#34; #å¼€æºåº“æ¦‚è¿°ï¼ˆæ‰“å¼€GitHubèƒ½çœ‹åˆ°çš„æè¿°ï¼‰ s.summary = \u0026#34;å¼€å‘ä¸­å¸¸ç”¨çš„è‡ªå®šä¹‰æ§ä»¶ã€å¼€å‘ç»éªŒã€å¼€å‘bugè®°å½•ï¼Œå¸¸ç”¨å®ã€categoriesç­‰å°è£…ï¼Œä¸å†æ¯ä¸ªé¡¹ç›®éƒ½æ‰‹åŠ¨é…ç½®ï¼Œç”¨Podç»Ÿä¸€ç®¡ç†ã€‚\u0026#34; #å¼€æºåº“æè¿° ï¼ˆè¿™ä¸ªæè¿°ä¼šè¢«ç”¨æ¥ç”Ÿæˆå¼€æºåº“çš„æ ‡ç­¾å’Œæé«˜è¢«æœåˆ°ï¼Œå¿…éœ€å†™åœ¨ä¸­é—´ä¸€è¡Œï¼Œåªè¦åœ¨ä¸­é—´ä¸€è¡Œï¼Œä¸éœ€è¦è€ƒè™‘ç¼©è¿›ï¼‰ s.description = \u0026lt;\u0026lt;-DESC å¼€å‘ä¸­ç»å¸¸ä»Aé¡¹ç›®copyä¸€äº›ä»£ç ï¼ˆæ¯”å¦‚å¸¸ç”¨çš„å®ã€categoryç­‰ï¼‰åˆ°Bé¡¹ç›®ï¼ŒAæ›´æ”¹äº†ä¸€ä¸ªcategoryï¼ŒBåˆè¦æ”¹åŠ¨ï¼›Bæ›´æ”¹äº†ä¸€ä¸ªcategoryï¼ŒAä¹Ÿè¦æ”¹åŠ¨ï¼Œä¸æ–¹ä¾¿åŒæ­¥ï¼Œå°±å®¹æ˜“å‡ºå·®é”™ï¼Œæ‰€ä»¥ï¼Œè€ƒè™‘ç”¨Podæ¥ç®¡ç†ã€‚ DESC #å¯ä»¥æ˜¯å¼€æºåº“çš„GitHubåœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ è‡ªå·±çš„ç½‘å€ç­‰ s.homepage = \u0026#34;https://github.com/chinesemanbobo/PPKit\u0026#34; #æˆ‘è¿™é‡Œæ˜¯å‚é ç½‘ä¸Šçš„ä¸€ç§å†™æ³•ï¼Œä¸ä¼šæŠ¥è­¦å‘Šï¼Œä¹Ÿå¯ä»¥ç›´æ¥ s.license = \u0026#39;MIT\u0026#39; s.license = { :type =\u0026gt; \u0026#39;MIT\u0026#39;, :text =\u0026gt; \u0026lt;\u0026lt;-LICENSE Copyright PPAbner 2016-2017 LICENSE } #å¼€æºåº“ä½œè€… s.author = { \u0026#34;chinesemanbobo\u0026#34; =\u0026gt; \u0026#34;chinesemanbobo@163.com\u0026#34; } #å¼€æºåº“ä½œè€…çš„ç¤¾äº¤é“¾æ¥ï¼ˆæ­¤å¤„æˆ‘æ”¾çš„æ˜¯å¾®åšï¼‰ s.social_media_url = \u0026#34;https://weibo.com/5366568018/profile?rightmod=1\u0026amp;wvr=6\u0026amp;mod=personnumber\u0026amp;is_all=1\u0026#34; #å¼€æºåº“æ”¯æŒçš„å¹³å°ï¼ˆæš‚æ—¶æ²¡è€ƒè™‘tvOSã€OSXç­‰ï¼‰ s.platform = :ios #å¼€æºåº“æœ€ä½æ”¯æŒ s.ios.deployment_target = \u0026#34;8.0\u0026#34; #VIP å¼€æºåº“GitHubçš„è·¯å¾„ä¸tagå€¼ï¼ŒGitHubè·¯å¾„åå¿…é¡»æœ‰.git,tagå®é™…å°±æ˜¯ä¸Šé¢çš„ç‰ˆæœ¬ s.source = { :git =\u0026gt; \u0026#34;https://github.com/chinesemanbobo/PPKit.git\u0026#34;, :tag =\u0026gt; s.version } #VIP å¼€æºåº“èµ„æºæ–‡ä»¶ ï¼ˆæˆ‘è‡ªå·±æ€»ç»“ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½è¦æœ‰è‡ªå·±çš„è·¯å¾„ï¼Œå°¤å…¶ä½ æƒ³ç›®å½•åˆ†çš„æ¯”è¾ƒè¯¦ç»†çš„è¯ï¼Œæ›´å…·ä½“çš„è¯´æ˜ï¼Œçœ‹å›¾å¯¹æ¯”ç€å†è¯´ï¼‰ s.source_files = \u0026#39;PPKit/PPKit.h\u0026#39;,\u0026#39;PPKit/PPMacros.h\u0026#39; #å­ç›®å½•PPHelpersï¼ˆ2çº§ï¼‰ï¼ŒPPKit(1çº§)ï¼Œsså­ç›®å½•å¯ä»¥éšä¾¿å†™ï¼Œä½†ä¸‹é¢è¦å¯¹åº” s.subspec \u0026#39;PPHelpers\u0026#39; do |ss| #å­ç›®å½•PPRuntimeHelper.hå’ŒPPRuntimeHelper.m ï¼ˆ3çº§ï¼‰ ss.source_files = \u0026#39;PPKit/PPHelpers/PPRuntimeHelper.{h,m}\u0026#39; end s.subspec \u0026#39;PPCategories\u0026#39; do |ss| ss.subspec \u0026#39;UI\u0026#39; do |ssui| ssui.subspec \u0026#39;UIScreen\u0026#39; do |ssuiscreen| ssuiscreen.source_files = \u0026#39;PPKit/PPCategories/UI/UIScreen/UIScreen+EasilySize.{h,m}\u0026#39; end end end #å¼€æºåº“å¤´æ–‡ä»¶ s.public_header_files = \u0026#39;PPKit/PPKit.h\u0026#39; #å¼€æºåº“ä¾èµ–åº“ # s.dependency \u0026#34;JSONKit\u0026#34;, \u0026#34;~\u0026gt; 1.4\u0026#34; # æ˜¯å¦æ”¯æŒarc s.requires_arc = true end 3.2 .podspecé‡Œé¢çš„.source_filesçš„å¸¸è§è¯­æ³•\nä¸€ä¸ªå®—æ—¨ï¼šåº“é‡Œé¢æ¯ä¸ªæ–‡ä»¶ã€èµ„æºéƒ½è¦æœ‰è·¯å¾„æŒ‡å‘å®ƒã€‚\n1 2 3 \u0026#34;PPKit/*\u0026#34; è¡¨ç¤ºåŒ¹é…æ‰€æœ‰PPKitç›®å½•ä¸‹æ–‡ä»¶ï¼Œä¸åŒ…å«å­ç›®å½•çš„ \u0026#34;PPKit/PPHelpers/*.{h,m}\u0026#34; è¡¨ç¤ºåŒ¹é…PPHelpersæ‰€æœ‰ä»¥.hå’Œ.mç»“å°¾çš„æ–‡ä»¶ \u0026#34;PPKit/**/*\u0026#34; è¡¨ç¤ºåŒ¹é…æ‰€æœ‰æ–‡ä»¶(ä¸»ç›®å½•å’Œå­ç›®å½•ï¼Œå…¶ä¸­**ç›¸å½“äºçœç•¥ä¸­é—´å±‚çº§) å…·ä½“çš„è¯­æ³•ç¤ºä¾‹åŠæˆªå›¾ï¼Œè§æ–‡ç« æœ€åé¢ï¼ˆå‚è€ƒé“¾æ¥ä¹‹å‰ï¼‰ã€‚\nç¬¬â‘£æ­¥ï¼šæ›´æ–°GitHub ä¾æ¬¡æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š\n1 2 3 4 5 $ git add -A \u0026amp;\u0026amp; git commit -m \u0026#34;ä½ çš„æ›´æ–°è¯´æ˜\u0026#34; //tagå€¼è¦å’Œ.podspceé‡Œçš„versionç›¸åŒï¼Œå¹¶ä¸”å¿…é¡»è®¾ç½® $ git tag \u0026#39;1.0.0\u0026#39; $ git push --tags $ git push origin master ç¬¬â‘¤æ­¥ï¼šéªŒè¯.podspecæ˜¯å¦æœ‰æ•ˆ 1 pod spec lint PPKit.podspec å¦‚æœéªŒè¯ä¸é€šè¿‡ï¼Œå¯ä»¥æ‰§è¡Œ**pod spec lint PPKit.podspec --verbose**æŸ¥çœ‹è¯¦ç»†çš„ERRORå’ŒWARINGæç¤ºï¼Œæ ¹æ®æç¤ºä¾æ¬¡è§£å†³ï¼Œç„¶åå›åˆ°ç¬¬å››æ­¥é‡æ–°æ¥ä¸€éã€‚ æ³¨æ„ï¼šåœ¨é‡æ–°å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬è¦åˆ é™¤è¿œç¨‹åº“çš„tagå’Œæœ¬åœ°çš„tagï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\n1 2 $ git tag -d 0.0.68 //åˆ é™¤æœ¬åœ°tag $ git push origin :refs/tags/0.0.68 // åˆ é™¤è¿œç¨‹åº“tag ç›´åˆ°å¦‚ä¸‹å›¾çš„éªŒè¯æˆåŠŸã€‚\nç¬¬â‘¥æ­¥ï¼šæäº¤.podspecåˆ°CocoaPods 1 pod trunk push PPKit.podspec å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æäº¤ï¼Œéœ€è¦å…ˆæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å»CocoaPodsæ³¨å†Œï¼ˆå¡«å†™é‚®ç®±ï¼Œæ”¶å–éªŒè¯é“¾æ¥ï¼Œç‚¹å‡»é“¾æ¥ï¼Œå°±OKï¼‰ï¼š\n1 $ pod trunk register é‚®ç®± \u0026#39;æ˜µç§°\u0026#39; --description=\u0026#39; è¿™é‡Œå†™æè¿°\u0026#39; ç„¶åå†æ‰§è¡Œï¼š\n1 pod trunk push PPKit.podspec OLAï¼Œåˆ°æ­¤å°±ç»“æŸäº†ï¼Œèµ¶ç´§å»pod searchä¸€ä¸‹ï¼Œçœ‹æœ‰æ²¡æœ‰ï¼\né‡åˆ°çš„é—®é¢˜s: pod search PPkitæœä¸å‡º ã€æ–¹æ¡ˆä¸€ã€‘cocoapods search è·å–ä¸åˆ°æœ€æ–°åº“çš„è§£å†³æ–¹æ³• æˆ‘ç”¨çš„æ˜¯ç¬¬äºŒç§ï¼šæ‰§è¡Œ pod repo updateæ›´æ–°æœ¬åœ°ä»“åº“ï¼Œå†pod search PPkit ï¼Œå°±èƒ½ æœåˆ°äº†ã€‚ ã€æ–¹æ¡ˆäºŒã€‘æ‰§è¡Œ pod search PPkit \u0026ndash;simple\nã€æ–¹æ¡ˆä¸‰ã€‘æ‰“å¼€~/Library/Caches/CocoaPods,åˆ é™¤search_index.jsonï¼Œè¯¥æ–‡ä»¶ä¼šåœ¨é‡æ–°æœç´¢æ—¶åˆ›å»ºã€‚\né™„ï¼šä»AFNetworking/PPKit/YYKitçœ‹podspecè¯­æ³•ã€‚ ç ”ç©¶äº†è‡ªå·±å¸¸ç”¨çš„å¼€æºåº“çš„æ–‡ä»¶ç›®å½•ï¼Œå…¶ä¸­**AFNetworkingæ˜¯æœ€å®Œç¾çš„ï¼Œä¹Ÿæ˜¯æˆ‘æœ€æƒ³è¦çš„ï¼Œè€Œå…¶å®ƒçš„å¤§å¤šæ•°éƒ½æ˜¯ï¼Œæ‰€æœ‰.hå’Œ.mæ–‡ä»¶éƒ½æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œæ¯”å¦‚ï¼šIQKeyboardManager**ã€‚å¯¹æ¯”å¦‚ä¸‹å›¾ï¼š\nå‚è€ƒ[AFNetworking](https://github.com/AFNetworking/AFNetworking)æ¥è¯´æ˜{}é‡Œé¢çš„å…±ç”¨ä»¥åŠå­ç›®å½•çš„è®¾ç½®ã€‚\nå¦‚ä¸‹å›¾ä¸­é—´çš„çº¿ï¼šAFURLRequestSerialization.hã€AFURLRequestSerialization.mä»¥åŠAFURLResponseSerialization.hå’ŒAFURLResponseSerialization.må¯ä»¥å†™ä¸º'AFNetworing/AFURL{Request,Response}Serialization.{h,m}'ã€‚æ‰€ä»¥ï¼š{}é‡Œé¢çš„ç”¨é€—å·ï¼ˆ,ï¼‰éš”å¼€ï¼Œç›¸å½“äºæ•°å­¦ä¸­çš„ç»„åˆ. Serializationæ–‡ä»¶ä¸éœ€è¦æŒ‡å®šè·¯å¾„ï¼Œåªéœ€è¦subspecè°ƒç”¨äº†å°±å¥½ï¼Œå®ƒå¤„äºç¬¬2çº§ç›®å½•ï¼Œé‡Œé¢é™¤äº†ä¸Šé¢çš„4ä¸ªæ–‡ä»¶åˆ«æ— å…¶å®ƒã€‚ä½†æ˜¯è¿™4ä¸ªæ–‡ä»¶å¿…é¡»æŒ‡å®šç›®å½•è·¯å¾„ï¼Œå¦‚ä¸Šé¢1ä¸­æ‰€ç¤ºã€‚ PPKité…ç½®ä¸æˆªå›¾è¯´æ˜ï¼Œå¦‚ä¸‹ï¼šè®°ä½é‚£ä¸ªåŸåˆ™ï¼šæ¯ä¸ªæ–‡ä»¶/è·¯å¾„éƒ½è¦æŒ‡å®šå¯¹åº”çš„è·¯å¾„ã€‚\nç”±YYKitå­¦ä¼šä¸ç†è§£.exclude_files\n.exclude_filesï¼Œå¿½ç•¥YYKitä¸‹çš„ï¼Œé‡æ–°å»ºæ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰æ¥ç®¡ç†ã€‚\n2017-11-24 03:51:40 è€—æ—¶6ä¸ªå°æ—¶å†™æ­¤æ–‡ï¼\nå‚è€ƒé“¾æ¥ï¼š Cocoapods: pod searchæ— æ³•æœç´¢åˆ°ç±»åº“çš„è§£å†³åŠæ³• ç»™è‡ªå·±çš„å¼€æºåº“æ·»åŠ cocopodsæ”¯æŒ è®©è‡ªå·±çš„å¼€æºé¡¹ç›®æ”¯æŒCocoaPods Cocoapodså®Œæ•´ä½¿ç”¨ç¯‡ ","date":"2017-11-24T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2017/20171124.jpeg","permalink":"https://abnerpei.github.io/p/20171124/","title":"ä½¿ç”¨CocoaPodsç®¡ç†iOSåº“---åˆ¶ä½œpodç¯‡"},{"content":" [èµ è¯­]ï¼šAnything you\u0026rsquo;re good at contributes to happiness.\nä¸€ã€ NSCharacterSetæ˜¯ä»€ä¹ˆâ“ 1.1 å…ˆæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\néœ€æ±‚ï¼š æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²: @\u0026ldquo;ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ NSCharacterSetæˆ‘ä»¬å¿«ä¹\u0026rdquo;ï¼Œå»é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„ @\u0026ldquo;ä»Š\u0026rdquo;ã€@\u0026ldquo;æˆ‘\u0026rdquo;ã€@\u0026ldquo;s\u0026rdquo;ã€‚ ã€æ³¨æ„ã€‘sæ˜¯å°å†™\næ€è€ƒï¼šå¦‚æœæ˜¯ä½ æ€ä¹ˆè§£å†³ï¼Ÿ\nè‡ªå·±å†™ã€‚ ç”¨ NSCharacterSetã€‚ 1.1.1 è‡ªå·±å†™,å¦‚ä¸‹ï¼š 1 2 3 4 5 6 7 8 9 10 11 12 13 NSString *str = @\u0026#34;ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ NSCharacterSetæˆ‘ä»¬å¿«ä¹\u0026#34;; NSString *str1 = @\u0026#34;æˆ‘sä»Š\u0026#34;; NSMutableString *resultStr = [[NSMutableString alloc]init]; for (int i = 0; i \u0026lt; str.length; i++) { NSString *indexStr = [str substringWithRange:NSMakeRange(i, 1)]; if (![str1 containsString:indexStr]) { [resultStr appendString:indexStr]; } } NSLog(@\u0026#34;è‡ªå·±å†™---%@\u0026#34;,resultStr); //2016-12-23 13:19:42.584 PPDemos[9065:6978391] è‡ªå·±å†™---å¤©ä»¬æ¥å­¦ä¹ NSCharacterSetä»¬å¿«ä¹ 1.1.2 ç”¨NSCharacterSet,å¦‚ä¸‹ï¼š 1 2 3 4 5 NSString *str = @\u0026#34;ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ NSCharacterSetæˆ‘ä»¬å¿«ä¹\u0026#34;; NSCharacterSet *characterSet = [NSCharacterSet characterSetWithCharactersInString:@\u0026#34;æˆ‘sä»Š\u0026#34;]; NSArray *setArr = [str componentsSeparatedByCharactersInSet:characterSet]; NSString *resultStr1 = [setArr componentsJoinedByString:@\u0026#34;\u0026#34;]; NSLog(@\u0026#34;æ‹†åˆ†åçš„å­—ç¬¦ä¸²æ•°ç»„------%@\\næœ€ç»ˆå­—ç¬¦ä¸²------%@\u0026#34;,setArr,resultStr1); æ€»ç»“ï¼š è‡³æ­¤ï¼Œé€šè¿‡ä¸Šé¢çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå·²ç»è§£å†³äº†éœ€æ±‚çš„é—®é¢˜ã€‚é€šè¿‡è‡ªå·±å†™ï¼Œç»“åˆç”¨NSCharacterSetï¼Œå¯ä»¥æ¨æ–­å‡ºNSCharacterSetç±»ä¼¼ä¸€ä¸ª å­—ç¬¦ä¸²å¤„ç†å·¥å…·ç±»ï¼Œè€Œäº‹å®ä¸Šï¼Œç”±åå­—ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå®ƒç¡®å®æ˜¯ï¼\näºŒã€ NSCharacterSetçš„å¸¸ç”¨APIå­¦ä¹  1 2 3 4 /** 001 æ ¹æ®ä¸€ä¸ªç»™å®šçš„å­—ç¬¦ä¸²è·å–ä¸€ä¸ªNSCharacterSetå¯¹è±¡ */ + (NSCharacterSet *)characterSetWithCharactersInString:(NSString *)aString; // ä½¿ç”¨å®ä¾‹ï¼Œå¦‚ä¸Šä¾‹ï¼ï¼ 1 2 /** 002 ç›¸åå­—ç¬¦ä¸²é™åˆ¶ ã€å…·ä½“è§æ¥ä¸‹çš„ä¾‹å­ã€‘ */ @property (readonly, copy) NSCharacterSet *invertedSet; 1 2 3 4 5 6 7 8 9 10 11 /** 003 å¸¸ç”¨å¿«æ·æ–¹æ³•é›†åˆ ï¼ˆå¸¸ç”¨çš„ï¼Œå·²æ»¡è¶³å¤§å¤šæ•°éœ€æ±‚ï¼‰ */ + controlCharacterSet + whitespaceCharacterSet //ç©ºæ ¼ + whitespaceAndNewlineCharacterSet //ç©ºæ ¼å’Œæ¢è¡Œç¬¦ + decimalDigitCharacterSet //0-9çš„æ•°å­— + letterCharacterSet //æ‰€æœ‰å­—æ¯ + lowercaseLetterCharacterSet //å°å†™å­—æ¯ + uppercaseLetterCharacterSet //å¤§å†™å­—æ¯ + alphanumericCharacterSet //æ‰€æœ‰æ•°å­—å’Œå­—æ¯ï¼ˆå¤§å°å†™ä¸åˆ†ï¼‰ + punctuationCharacterSet //æ ‡ç‚¹ç¬¦å· + newlineCharacterSet //æ¢è¡Œ 002 çš„ ä¾‹å­ 1 2 3 4 5 6 7 8 NSCharacterSet *set = [NSCharacterSet characterSetWithCharactersInString:@\u0026#34;0123456789\u0026#34;]; NSString *str = @\u0026#34;7sjf78sf990s\u0026#34;; NSLog(@\u0026#34;set----%@\u0026#34;,[str componentsSeparatedByCharactersInSet:set]); NSCharacterSet *invertedSet = [[NSCharacterSet characterSetWithCharactersInString:@\u0026#34;0123456789\u0026#34;] invertedSet]; NSLog(@\u0026#34;invertedSet----%@\u0026#34;,[str componentsSeparatedByCharactersInSet:invertedSet]); //æ‰“å°ç»“æœå¦‚ä¸‹å›¾ï¼š ã€å¯ä»¥çœ‹å‡ºinvertedSetåï¼Œåˆšå¥½åˆ¤æ–­æ¡ä»¶ç›¸åã€‘ æ˜ç™½äº†001å’Œ002ï¼Œä¸‹é¢æœ‰ä¸ªéœ€æ±‚ï¼Œè¯¥æ€ä¹ˆå®ç°ï¼Ÿè‡ªå·±æƒ³å§ï¼\néœ€æ±‚ï¼štextFielfåªèƒ½è¾“å…¥æ•°å­—\nä¸‰ã€ NSMutableCharacterSetçš„å¸¸ç”¨APIå­¦ä¹  NSCharacterSetçš„ï¼ŒNSMutableCharacterSetéƒ½å¯ä»¥ç”¨ã€‚ã€è¿™å¥è²Œä¼¼æœ‰äº›å¤šä½™ã€‘ã€‚\n1 2 /** å·¥èƒ½åŒ invertedSet æ–¹æ³•ä¸€æ ·ï¼Œæ³¨æ„è¿™ä¸ªæ²¡æœ‰è¿”å›å€¼ */ - (void)invert; é™„ textFielfåªèƒ½è¾“å…¥æ•°å­—çš„ç­”æ¡ˆ,å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string { NSCharacterSet *charSet = [[NSCharacterSet characterSetWithCharactersInString:@\u0026#34;0123456789\u0026#34;] invertedSet]; NSString *filteredStr = [[string componentsSeparatedByCharactersInSet:charSet] componentsJoinedByString:@\u0026#34;\u0026#34;]; if ([string isEqualToString:filteredStr]) { return YES; } return NO; } ","date":"2016-12-23T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2016/20161213.jpeg","permalink":"https://abnerpei.github.io/p/%E5%AD%A6%E4%BC%9Anscharacterset%E5%86%8D%E4%B9%9F%E4%B8%8D%E6%80%95%E5%90%84%E7%A7%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86/","title":"å­¦ä¼šNSCharacterSetï¼Œå†ä¹Ÿä¸æ€•å„ç§å­—ç¬¦ä¸²å¤„ç†ï¼"},{"content":" PPTextField\nPPTextField ä¸€ä¸ªå±æ€§æå®štextfieldçš„å„ç§ï¼ˆçº¯æ•°å­—ï¼Œæ•°å­—æœ€å¤§ä¸ªæ•°ï¼Œä»·æ ¼ï¼Œå­—ç¬¦ä¸²é•¿åº¦ã€åŒºåˆ†ä¸­è‹±æ–‡ï¼Œä¸åŒºåˆ†ã€‘ç­‰ï¼‰é™åˆ¶\nè¾“å…¥å®Œæˆåï¼Œä»¥å¾ˆå¿«çš„é€Ÿåº¦ç‚¹å‡»é”®ç›˜æ—¶ï¼Œå­—ç¬¦ä¸²çš„åæ›¿æ¢æ‰æœ€åä¸€ä¸ªï¼Œè°æœ‰è§£å†³æ–¹æ³•ï¼Œæ±‚æŒ‡å¯¼ï¼ï¼ï¼è°¢è°¢ï¼\nä½œç”¨ï¼šå¤„ç†å„ç§çƒ¦äººçš„é™åˆ¶ åœ¨å¼€å‘ä¸­ï¼Œä½ æ˜¯å¦é‡åˆ°ä»¥ä¸‹çš„äº§å“éœ€æ±‚ï¼š\n1 2 3 4 5 1\u0026gt; æ‰‹æœºå·å¿…é¡»æ˜¯11ä½çº¯æ•°å­—ï¼Œå¤šäº†ä¸èƒ½è¾“å…¥ 2\u0026gt; å¯†ç åªèƒ½æ˜¯æ•°å­—å’Œå­—æ¯ 3\u0026gt; ä»·æ ¼å¿…é¡»ä¿ç•™ä¸¤ä½å°æ•°ï¼Œå¹¶ä¸”ç”¨æˆ·ç¬¬ä¸€ä¸ªè¾“å…¥â€œ.â€ï¼Œè¦å˜ä¸ºâ€œ0.â€ï¼Œå°æ•°ç‚¹åè¶…è¿‡2ä½ä¸èƒ½å†è¾“å…¥ 4\u0026gt; ä¸€ä¸ªä¸­æ–‡ç®—2ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªè‹±æ–‡ç®—1ä¸ªå­—ç¬¦ï¼Œåˆèµ·æ¥ä¸è¶…è¿‡10ä¸ªå­—ç¬¦ 5\u0026gt; ä¸ç®¡ä½ ä¸­æ–‡è‹±æ–‡ï¼Œæœ€å¤šåˆ«è¶…è¿‡12ä¸ªå­—ç¬¦ ç­‰ç­‰ï¼Œæ¯æ¬¡éƒ½æ˜¯éµå¾ªä»£ç†ï¼Œå†™ä¸€å¤§å †ä»£ç ï¼Œå¤ªéº»çƒ¦äº†ï¼Œä»Šå¤©æˆ‘æŠŠè¿™äº›éƒ½é›†ä¸­èµ·æ¥ï¼Œæ•´ç†ä¸‹ï¼Œåˆ†äº«å‡ºæ¥ï¼\nPPTextFieldç®€å•æ˜“ç”¨API 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** çº¯æ•°å­— */ @property(nonatomic,assign)BOOL isOnlyNumber; /** æœ€å¤šçº¯æ•°å­—ä¸ªæ•°ã€isOnlyNumber == yes æœ‰æ•ˆã€‘ï¼Œæ¯”å¦‚æ‰‹æœº11ä½ï¼Œå•†å“æ¡ç 13ä½ç­‰ ã€è®¾ç½®äº†maxNumberCount,å°±é»˜è®¤ isOnlyNumber = YESã€‘*/ @property(nonatomic,assign)NSInteger maxNumberCount; /** ä»·æ ¼(åªæœ‰ä¸€ä¸ª\u0026#34;.\u0026#34;ï¼Œå°æ•°ç‚¹åä¿ç•™2ä½å°æ•°) */ @property(nonatomic,assign)BOOL isPrice; /** ä»·æ ¼æ˜¯å¦å…è®¸ä»¥â€œ.â€å¼€å¤´ï¼Œé»˜è®¤æ˜¯ä¸å…è®¸ï¼Œå¦‚æœå…è®¸ï¼Œè¯·è®¾ç½®ä¸ºYES ã€è®¾ç½®äº†isPriceHeaderPoint,å°±é»˜è®¤ isPrice = YESã€‘*/ @property(nonatomic,assign)BOOL isPriceHeaderPoint; /** å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ï¼ˆä¸€ä¸ªä¸­æ–‡2ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªè‹±æ–‡1ä¸ªå­—ç¬¦ã€ä¸­æ–‡è¾“å…¥æ³•ä¸‹çš„éƒ½ç®—ä¸­æ–‡ã€‘ï¼‰ */ @property(nonatomic,assign)NSInteger maxCharactersLength; /** tf.textæœ€å¤§é•¿åº¦ï¼ˆä¸è€ƒè™‘ä¸­è‹±æ–‡ï¼‰ */ @property(nonatomic,assign)NSInteger maxTextLength; å˜¿å˜¿ï¼Œä¸€åˆ‡éƒ½åœ¨ä¸è¨€ä¸­ï¼ï¼ï¼\n","date":"2016-10-10T00:00:00Z","image":"https://ap-hexo-blog-images.oss-cn-shanghai.aliyuncs.com/BlogCover/2016/20161010.jpeg","permalink":"https://abnerpei.github.io/p/20161010/","title":"PPTextFieldï¼Œä¸€ä¸ªå±æ€§æå®šUITextFieldçš„å„ç§é™åˆ¶ï¼Œå†ä¹Ÿä¸ç”¨å†™ä¸€å¤§å †ä»£ç†äº†"},{"content":"å‘ç°å›°æƒ‘ åœ¨æ•´ç† [[ã€Core Animationã€CAKeyframeAnimationå®æˆ˜ä¹‹å¿ƒè·³+é›·è¾¾]] ä¸­çš„ [[ã€Core Animationã€CAKeyframeAnimationå®æˆ˜ä¹‹å¿ƒè·³+é›·è¾¾#keyTimes|keyTimes]] æ—¶ï¼Œå‘ç° keyTimes æ˜¯ [NSNumber]? ç±»å‹çš„ï¼Œä½†æ˜¯é¡¹ç›®ä¸­ä»£ç å´æ˜¯ Float ç±»å‹æ•°ç»„ï¼ˆå¦‚ä¸‹ä»£ç ï¼‰ï¼Œç¼–è¯‘ã€è¿è¡Œç«Ÿéƒ½æ²¡æœ‰æŠ¥é”™ï¼ŒWhyï¼Ÿ\n1 keyframeAnimation.keyTimes = [0, 0.25, 0.55, 0.8, 1.0] æŸ¥æ‰¾ç­”æ¡ˆ æœç´¢ swift nsnumber ï¼Œç›´åˆ°çœ‹åˆ° ä¸ºä»€ä¹ˆæ•°å­—æ–‡å­—å¯ä»¥è§£é‡Šä¸ºSwiftä¸­çš„NSNumberï¼Ÿ ä¸­çš„å›ç­”ï¼š\nNSNumberÂ ç¬¦åˆExpressibleByBooleanLiteralï¼ŒExpressibleByFloatLiteralÂ å’ŒExpressibleByIntegerLiteral åè®®ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ ä»å¸ƒå°”å€¼ï¼Œæµ®ç‚¹æˆ–æ•´æ•°æ–‡å­—åˆå§‹åŒ–ï¼š\n1 2 3 let n1: NSNumber = false let n2: NSNumber = 12.34 let n3: NSNumber = 123 è™½ç„¶ç­”æ¡ˆæ˜¯æ‰¾åˆ°äº†ï¼Œä½†è¿™ä¸ªæœç´¢ç»“æœæ˜¾ç„¶ä¸æ˜¯æºåœ°å€ï¼Œæ‰€ä»¥å°±å» Stack Overflow ä¸Šæœäº†ä¸€ä¸‹ ExpressibleByIntegerLiteral ï¼Œæ‰¾åˆ°äº†æºåœ°å€ï¼šWhy can a numeric literal be interpreted as an NSNumber in Swift? éªŒè¯ç­”æ¡ˆ extension NSNumber 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 extension NSNumber : ExpressibleByFloatLiteral, ExpressibleByIntegerLiteral, ExpressibleByBooleanLiteral { /// Create an instance initialized to `value`. @nonobjc required public convenience init(integerLiteral value: Int) /// Create an instance initialized to `value`. @nonobjc required public convenience init(floatLiteral value: Double) /// Create an instance initialized to `value`. @nonobjc required public convenience init(booleanLiteral value: Bool) /// A type that represents a Boolean literal, such as `Bool`. public typealias BooleanLiteralType = Bool /// A type that represents a floating-point literal. /// /// Valid types for `FloatLiteralType` are `Float`, `Double`, and `Float80` /// where available. public typealias FloatLiteralType = Double /// A type that represents an integer literal. /// /// The standard library integer and floating-point types are all valid types /// for `IntegerLiteralType`. public typealias IntegerLiteralType = Int } ExpressibleByFloatLiteral 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 /// A type that can be initialized with a floating-point literal. /// /// The standard library floating-point types---`Float`, `Double`, and /// `Float80` where available---all conform to the `ExpressibleByFloatLiteral` /// protocol. You can initialize a variable or constant of any of these types /// by assigning a floating-point literal. /// /// // Type inferred as \u0026#39;Double\u0026#39; /// let threshold = 6.0 /// /// // An array of \u0026#39;Double\u0026#39; /// let measurements = [2.2, 4.1, 3.65, 4.2, 9.1] /// /// Conforming to ExpressibleByFloatLiteral /// ======================================= /// /// To add `ExpressibleByFloatLiteral` conformance to your custom type, /// implement the required initializer. public protocol ExpressibleByFloatLiteral { /// A type that represents a floating-point literal. /// /// Valid types for `FloatLiteralType` are `Float`, `Double`, and `Float80` /// where available. associatedtype FloatLiteralType : _ExpressibleByBuiltinFloatLiteral /// Creates an instance initialized to the specified floating-point value. /// /// Do not call this initializer directly. Instead, initialize a variable or /// constant using a floating-point literal. For example: /// /// let x = 21.5 /// /// In this example, the assignment to the `x` constant calls this /// floating-point literal initializer behind the scenes. /// /// - Parameter value: The value to create. init(floatLiteral value: Self.FloatLiteralType) } æœ€å è™½ç„¶çŸ¥é“äº†ç­”æ¡ˆï¼Œä½†æ˜¯å¯¹äº ExpressibleByFloatLiteral çš„ç†è§£è¿˜æ˜¯å¾ˆè¿·ç³Šï¼Œäºæ˜¯åˆçœ‹äº†ä¸€ä¸‹ Swift ExpressibleByIntegerLiteral - How exactly does it work? ï¼Œä¼¼ä¹æ‰æ˜ç™½é‚£ä¹ˆä¸€äº›ï¼š\nIt\u0026rsquo;sÂ compiler magic, so unfortunately you cannot declare such a protocol yourself.\n","date":"0001-01-01T00:00:00Z","permalink":"https://abnerpei.github.io/p/","title":""}]